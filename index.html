<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>elfvisor - AI Shopping Assistant</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Montserrat:wght@300;400;500;600;700&display=swap');
        
        body {
            font-family: 'Montserrat', sans-serif;
        }
        
        .font-serif {
            font-family: 'Montserrat', sans-serif;
        }

        /* Custom Scrollbar for Chat */
        .no-scrollbar::-webkit-scrollbar {
            display: none;
        }
        .no-scrollbar {
            -ms-overflow-style: none;
            scrollbar-width: none;
        }

        .fade-in {
            animation: fadeIn 0.5s ease-in-out forwards;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Typing cursor animation */
        .typing-cursor::after {
            content: '|';
            animation: blink 0.7s infinite;
            color: #000;
            font-weight: 400;
        }

        @keyframes blink {
            0%, 50% { opacity: 1; }
            51%, 100% { opacity: 0; }
        }

        /* Routine step connector line */
        .routine-step:not(:last-child)::after {
            content: '';
            position: absolute;
            left: 24px;
            top: 48px;
            bottom: -24px;
            width: 2px;
            background: linear-gradient(to bottom, #000 0%, #e5e7eb 100%);
        }

        /* Comparison table styling */
        .comparison-card {
            background: linear-gradient(135deg, #fafafa 0%, #f5f5f5 100%);
        }

        .savings-badge {
            background: linear-gradient(135deg, #4ADE80 0%, #22C55E 100%);
        }

        /* Cart drawer */
        .cart-drawer {
            transform: translateX(100%);
            transition: transform 0.3s ease-in-out;
        }

        .cart-drawer.open {
            transform: translateX(0);
        }

        .cart-overlay {
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.3s ease-in-out;
        }

        .cart-overlay.open {
            opacity: 1;
            pointer-events: auto;
        }

        /* Toast notification */
        .toast {
            transform: translateY(100px);
            opacity: 0;
            transition: all 0.3s ease-out;
        }

        .toast.show {
            transform: translateY(0);
            opacity: 1;
        }

        /* Cart badge pulse */
        @keyframes cartPulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.3); }
            100% { transform: scale(1); }
        }

        .cart-pulse {
            animation: cartPulse 0.3s ease-out;
        }

        /* Progress steps animation */
        .progress-step {
            animation: fadeInUp 0.3s ease-out forwards;
        }

        @keyframes fadeInUp {
            from { opacity: 0; transform: translateY(5px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Add to cart button animation */
        .add-btn-success {
            animation: addSuccess 0.5s ease-out;
        }

        @keyframes addSuccess {
            0% { transform: scale(1); }
            30% { transform: scale(0.95); background-color: #22C55E; }
            60% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }
    </style>
</head>
<body class="bg-white text-black h-screen flex flex-col overflow-hidden">

    <!-- Header -->
    <header class="bg-black text-white h-[50px] flex items-center justify-between px-6 fixed top-0 w-full z-50 text-xs tracking-wide">
        <div class="flex items-center gap-6">
            <div class="flex items-center gap-1 font-bold cursor-pointer hover:text-gray-300 transition-colors">
                <span>üéÅ</span> Gifts
            </div>
            <div class="flex items-center gap-1 font-bold cursor-pointer hover:text-gray-300 transition-colors">
                <span>üî•</span> What's Hot
            </div>
            <a href="#" class="hover:text-gray-300 hidden md:block">Makeup</a>
            <a href="#" class="hover:text-gray-300 hidden md:block">Skincare</a>
        </div>

        <div class="absolute left-1/2 transform -translate-x-1/2 cursor-pointer flex items-center justify-center h-full">
            <svg width="48" height="48" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg" class="h-8 w-auto" aria-hidden="true">
                <path d="M10.2695 20.9688C16.9849 20.9688 19.6055 26.9227 19.6055 31.332H2.54492C2.54496 38.7949 7.05107 41.6953 11.0977 41.6953C15.1442 41.6952 17.7197 38.7412 17.7197 38.7412L18.5938 39.5596C16.8462 41.15 14.1791 42.9678 10.5459 42.9678C5.27215 42.9677 0 38.9681 0 31.7861C0.000110383 24.6043 4.73639 20.9688 10.2695 20.9688ZM28.2969 42.6963H25.7676V8.5918C25.7676 6.72798 27.0324 6.12109 28.2969 6.12109V42.6963ZM42.875 6C46.444 6 47.9819 8.60987 47.9971 8.63574L47.2295 9.30273C46.5864 8.42456 45.2675 7.08984 43.2139 7.08984C39.503 7.08996 38.4004 10.425 38.4004 14.3936V20.9688H44.8389V22.332H38.4004V42.6963H35.9473V14.4551C35.9473 8.51535 39.2884 6.0002 42.875 6ZM21.6748 41.1943C22.0924 41.1945 22.4324 41.5306 22.4326 41.9434C22.4326 42.3563 22.0926 42.6932 21.6748 42.6934C21.2569 42.6934 20.917 42.3563 20.917 41.9434C20.9172 41.5305 21.2555 41.1943 21.6748 41.1943ZM32.123 41.1943C32.5407 41.1945 32.8807 41.5306 32.8809 41.9434C32.8809 42.3563 32.5408 42.6932 32.123 42.6934C31.7052 42.6934 31.3652 42.3563 31.3652 41.9434C31.3654 41.5305 31.7038 41.1943 32.123 41.1943ZM42.3926 41.1943C42.8102 41.1945 43.1502 41.5306 43.1504 41.9434C43.1504 42.3563 42.8103 42.6932 42.3926 42.6934C41.9747 42.6934 41.6348 42.3563 41.6348 41.9434C41.635 41.5305 41.9733 41.1943 42.3926 41.1943ZM9.99414 21.9688C6.08448 21.969 2.63586 26.0353 2.63574 30.1035H17.0752C16.7185 24.5114 13.5567 22.1196 10.3076 21.9756L9.99414 21.9688Z" fill="white"/>
            </svg>
        </div>

        <div class="flex items-center gap-4">
            <span class="font-bold flex items-center gap-1 hidden md:flex">‚ú® FAN: 1065 pts</span>
            <div class="relative hidden md:block">
                <span class="absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400">üîç</span>
                <input 
                    type="text" 
                    placeholder="Search" 
                    class="bg-transparent border border-gray-600 rounded-full py-1 pl-8 pr-4 text-xs focus:outline-none focus:border-white w-[120px]"
                >
            </div>
            <span class="text-xl cursor-pointer">üá∫üá∏</span>
            <span class="text-lg cursor-pointer hover:text-gray-300">‚ù§Ô∏è</span>
            <div class="w-6 h-6 rounded-full bg-[#fcdbb0] text-black flex items-center justify-center font-bold text-xs cursor-pointer">PW</div>
            <div class="relative cursor-pointer" onclick="openCart()">
                <span class="text-lg hover:text-gray-300 transition-colors">üõçÔ∏è</span>
                <span id="cart-badge" class="hidden absolute -top-2 -right-2 bg-[#4ADE80] text-black text-[10px] font-bold w-5 h-5 rounded-full flex items-center justify-center">0</span>
            </div>
        </div>
    </header>

    <!-- Main Container -->
    <main id="app-container" class="flex-1 flex mt-[50px] overflow-hidden relative w-full h-full">
        
        <!-- New Chat Button (hidden initially, shown after chat starts) -->
        <button 
            id="new-chat-btn"
            onclick="location.reload()" 
            class="hidden absolute top-4 right-4 z-30 flex items-center gap-1 text-xs font-semibold cursor-pointer hover:bg-gray-100 transition-colors border border-gray-300 rounded-full px-3 py-1.5 bg-white shadow-sm"
        >
            <span>+</span> New Chat
        </button>

        <!-- View 1: Initial State (Centered) -->
        <div id="initial-view" class="absolute inset-0 flex flex-col items-center justify-center p-4 bg-white z-20 transition-all duration-500">
            <div class="w-full max-w-2xl text-center space-y-8">
                <h1 class="text-4xl md:text-6xl font-medium tracking-tight">
                    What are you shopping for today?
                </h1>
                <div class="relative w-full">
                    <input
                        type="text"
                        id="initial-input"
                        placeholder="Message elfvisor..."
                        class="w-full p-6 pr-12 rounded-3xl border border-gray-200 shadow-sm text-lg focus:outline-none focus:ring-2 focus:ring-black/5 focus:border-black transition-all"
                        style="background-color: #F3F4F6;"
                        autofocus
                    >
                    <button 
                        onclick="handleInitialSubmit()"
                        class="absolute right-4 top-1/2 -translate-y-1/2 p-2 bg-gray-100 rounded-full text-gray-500 hover:bg-black hover:text-white transition-colors"
                    >
                        ‚û§
                    </button>
                </div>
                <div class="flex flex-wrap gap-3 justify-center text-sm" style="color: #4B5563;">
                    <button onclick="setInitialQuery('Give me a morning skincare routine for dry skin')" class="px-4 py-2 rounded-full hover:bg-gray-100 transition-colors" style="background-color: #F3F4F6;">Morning routine for dry skin</button>
                    <button onclick="setInitialQuery('Find me an ELF dupe for Charlotte Tilbury Hollywood Flawless Filter')" class="px-4 py-2 rounded-full hover:bg-gray-100 transition-colors" style="background-color: #F3F4F6;">CT Flawless Filter dupe</button>
                    <button onclick="setInitialQuery('Build me a full face makeup routine')" class="px-4 py-2 rounded-full hover:bg-gray-100 transition-colors" style="background-color: #F3F4F6;">Full face makeup routine</button>
                </div>
            </div>
        </div>

        <!-- View 2 & 3: Split Layout (Chat + Results) -->
        <div id="split-view" class="w-full h-full flex opacity-0 transition-opacity duration-700 pointer-events-none">
            
            <!-- Left: Chat Interface (starts full width, shrinks when content appears) -->
            <div id="chat-panel" class="w-full md:w-full flex flex-col bg-white z-10 h-full relative transition-all duration-500">
                <div id="chat-history" class="flex-1 overflow-y-auto p-6 space-y-6 pb-24 no-scrollbar max-w-2xl mx-auto w-full transition-all duration-500">
                    <!-- Chat messages will be injected here -->
                </div>

                <!-- Fixed Input Area -->
                <div class="absolute bottom-0 w-full p-4 border-t border-gray-100 bg-white">
                    <div id="chat-input-wrapper" class="relative max-w-2xl mx-auto transition-all duration-500">
                    <input
                        id="chat-input"
                        type="text"
                        placeholder="Ask a follow-up question..."
                        class="w-full rounded-full py-3 px-6 pr-12 text-sm focus:outline-none focus:ring-1 focus:ring-gray-200"
                        style="background-color: #F3F4F6;"
                    >
                        <button onclick="handleChatSubmit()" class="absolute right-3 top-1/2 -translate-y-1/2 p-1.5 bg-gray-200 rounded-full text-gray-500 hover:bg-black hover:text-white transition-colors">
                           ‚û§
                        </button>
                    </div>
                </div>
            </div>

            <!-- Right: Dynamic Content Panel (hidden until content is ready) -->
            <div id="product-panel" class="hidden flex-1 bg-white overflow-y-auto p-8 transition-all duration-500 border-l border-gray-100">

                <!-- Grid State (default product view) -->
                <div id="product-grid" class="hidden grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-x-6 gap-y-10 max-w-6xl mx-auto">
                    <!-- Products injected here -->
                </div>

                <!-- Routine View -->
                <div id="routine-view" class="hidden max-w-3xl mx-auto">
                    <!-- Routine steps injected here -->
                </div>

                <!-- Comparison View -->
                <div id="comparison-view" class="hidden max-w-4xl mx-auto">
                    <!-- Comparison table injected here -->
                </div>

            </div>
        </div>
    </main>

    <!-- Cart Overlay -->
    <div id="cart-overlay" class="cart-overlay fixed inset-0 bg-black/50 z-[60]" onclick="closeCart()"></div>

    <!-- Cart Drawer -->
    <div id="cart-drawer" class="cart-drawer fixed top-0 right-0 h-full w-full max-w-md bg-white shadow-2xl z-[70] flex flex-col">
        <!-- Cart Header -->
        <div class="flex items-center justify-between p-6 border-b border-gray-100">
            <h2 class="text-xl font-bold">YOUR BAG (<span id="cart-count-drawer">0</span>)</h2>
            <button onclick="closeCart()" class="p-2 hover:bg-gray-100 rounded-full transition-colors">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
                </svg>
            </button>
        </div>

        <!-- Cart Items -->
        <div id="cart-items" class="flex-1 overflow-y-auto p-6 space-y-4">
            <!-- Cart items will be injected here -->
            <div id="cart-empty" class="flex flex-col items-center justify-center h-full text-gray-400">
                <span class="text-5xl mb-4">üõçÔ∏è</span>
                <p class="text-lg font-medium">Your bag is empty</p>
                <p class="text-sm">Add some products to get started!</p>
            </div>
        </div>

        <!-- Cart Footer -->
        <div id="cart-footer" class="hidden border-t border-gray-100 p-6 space-y-4 bg-gray-50">
            <div class="flex justify-between items-center">
                <span class="text-gray-600">Subtotal</span>
                <span id="cart-subtotal" class="text-2xl font-bold">$0</span>
            </div>
            <div id="free-shipping-msg" class="text-sm text-center py-2 px-4 rounded-full bg-blue-50 text-blue-700">
                Add <span id="shipping-remaining">$35</span> more for FREE shipping!
            </div>
            <button class="w-full bg-black text-white font-bold py-4 rounded-full hover:bg-gray-800 transition-colors">
                CHECKOUT
            </button>
            <p class="text-xs text-center text-gray-500">
                FREE FULL SIZE GIFT with orders $35+
            </p>
        </div>
    </div>

    <!-- Toast Notification -->
    <div id="toast" class="toast fixed bottom-6 left-1/2 -translate-x-1/2 bg-black text-white px-6 py-3 rounded-full shadow-lg z-[80] flex items-center gap-3">
        <span class="text-green-400">‚úì</span>
        <span id="toast-message">Added to bag!</span>
    </div>

    <!-- Load API config (gitignored - copy config.example.js to config.js) -->
    <script src="config.js"></script>
    
    <script>
        // ===========================================
        // CONFIGURATION
        // ===========================================
        // API key is loaded from config.js (gitignored)
        // Copy config.example.js to config.js and add your key
        const OPENAI_API_KEY = (typeof CONFIG !== 'undefined') ? CONFIG.OPENAI_API_KEY : 'YOUR_OPENAI_API_KEY_HERE';

        // ===========================================
        // PRODUCT CATALOG - Enhanced Schema
        // ===========================================
        const ALL_PRODUCTS = [
            // === SKINCARE - CLEANSERS ===
            {
                id: "holy-hydration-cleanser",
                name: "Holy Hydration! Makeup Melting Cleanser",
                price: 10,
                rating: 4.7,
                reviews: 3200,
                badge: null,
                badgeColor: null,
                badgeStyle: null,
                shades: [],
                cta: "ADD TO BAG",
                image: "https://www.elfcosmetics.com/dw/image/v2/BBXC_PRD/on/demandware.static/-/Sites-elf-master/default/dw616007d6/2025/HH!CleanFreakDailyCleanser/57422_Closed_V4_R.jpg?sfrm=png&sw=600&q=90",
                category: "skincare",
                skinType: ["Dry", "Normal", "Combination"],
                coverage: null,
                // NEW FIELDS
                productType: "cleanser",
                routineStep: "both",
                applicationOrder: 1,
                usage: "Massage onto dry skin to melt away makeup, then rinse with warm water. Can also be used on damp skin as a gentle cleanser.",
                benefits: ["makeup removing", "hydrating", "gentle", "non-stripping"],
                keyIngredients: ["squalane", "vitamin E", "hyaluronic acid"],
                concerns: ["dryness", "sensitive skin", "makeup removal"],
                similarTo: [
                    { brand: "Clinique", product: "Take The Day Off Cleansing Balm", price: 36 },
                    { brand: "Farmacy", product: "Green Clean Makeup Meltaway", price: 36 }
                ]
            },
            // === SKINCARE - SERUMS ===
            {
                id: "holy-hydration-serum",
                name: "Holy Hydration! Thirst Burst Drops",
                price: 13,
                rating: 4.6,
                reviews: 2706,
                badge: "Hydrating",
                badgeColor: "text-white",
                badgeStyle: "background-color: #4ADE80;",
                shades: [],
                cta: "ADD TO BAG",
                image: "https://www.elfcosmetics.com/dw/image/v2/BBXC_PRD/on/demandware.static/-/Sites-elf-master/default/dw459c3d0a/2024/ThirstBurstDrops/57586_CLOSED_v5_R.jpg?sfrm=png&sw=600&q=90",
                category: "skincare",
                skinType: ["Dry", "Normal", "Combination"],
                coverage: null,
                productType: "serum",
                routineStep: "both",
                applicationOrder: 2,
                usage: "Apply 2-3 drops to clean skin before moisturizer. Pat gently until absorbed.",
                benefits: ["intense hydration", "plumping", "dewy finish", "lightweight"],
                keyIngredients: ["hyaluronic acid", "squalane", "niacinamide"],
                concerns: ["dehydration", "dullness", "fine lines"],
                similarTo: [
                    { brand: "The Ordinary", product: "Hyaluronic Acid 2% + B5", price: 9 },
                    { brand: "Drunk Elephant", product: "B-Hydra Intensive Hydration Serum", price: 48 }
                ]
            },
            // === SKINCARE - MOISTURIZERS ===
            {
                id: "holy-hydration-face-cream",
                name: "Holy Hydration! Face Cream",
                price: 14,
                rating: 4.8,
                reviews: 5500,
                badge: "Best Seller",
                badgeColor: "text-black",
                badgeStyle: "background-color: #FACC15;",
                shades: [],
                cta: "ADD TO BAG",
                image: "https://www.elfcosmetics.com/dw/image/v2/BBXC_PRD/on/demandware.static/-/Sites-elf-master/default/dwf49f8bd5/2024/HolyHydrationRepack/82829_CLOSED_v2_R.jpg?sfrm=png&sw=600&q=90",
                category: "skincare",
                skinType: ["Dry", "Normal"],
                coverage: null,
                productType: "moisturizer",
                routineStep: "both",
                applicationOrder: 3,
                usage: "Apply a generous amount to face and neck after serum. Best when skin is slightly damp.",
                benefits: ["deep hydration", "barrier repair", "non-greasy", "long-lasting moisture"],
                keyIngredients: ["hyaluronic acid", "squalane", "niacinamide", "peptides"],
                concerns: ["dry skin", "dehydration", "flakiness"],
                similarTo: [
                    { brand: "CeraVe", product: "Moisturizing Cream", price: 19 },
                    { brand: "Tatcha", product: "The Dewy Skin Cream", price: 69 }
                ]
            },
            {
                id: "gel-yeah-moisturizer",
                name: "Holy Hydration! Gel-Yeah Moisturizer",
                price: 13,
                rating: 4.5,
                reviews: 4338,
                badge: "Oil-Free",
                badgeColor: "text-white",
                badgeStyle: "background-color: #4ADE80;",
                shades: [],
                cta: "ADD TO BAG",
                image: "https://www.elfcosmetics.com/dw/image/v2/BBXC_PRD/on/demandware.static/-/Sites-elf-master/default/dwf444ad04/2023/HHGelYeahMoisturizer/57430_Closed_R.jpg?sfrm=png&sw=600&q=90",
                category: "skincare",
                skinType: ["Oily", "Combination"],
                coverage: null,
                productType: "moisturizer",
                routineStep: "both",
                applicationOrder: 3,
                usage: "Apply to clean skin morning and night. Perfect under makeup for oily skin types.",
                benefits: ["oil-free", "lightweight", "mattifying", "hydrating without heaviness"],
                keyIngredients: ["hyaluronic acid", "aloe vera", "niacinamide"],
                concerns: ["oily skin", "shine control", "acne-prone skin"],
                similarTo: [
                    { brand: "Neutrogena", product: "Hydro Boost Water Gel", price: 20 },
                    { brand: "Clinique", product: "Dramatically Different Moisturizing Gel", price: 34 }
                ]
            },
            // === SKINCARE - SUNSCREEN ===
            {
                id: "whoa-glow-spf",
                name: "Suntouchable! Whoa Glow SPF 30",
                price: 14,
                rating: 4.8,
                reviews: 4718,
                badge: "Best Seller",
                badgeColor: "text-black",
                badgeStyle: "background-color: #FACC15;",
                shades: [],
                cta: "ADD TO BAG",
                image: "https://www.elfcosmetics.com/dw/image/v2/BBXC_PRD/on/demandware.static/-/Sites-elf-master/default/dw56f702a5/2024/SuntouchableUpdatedAssets_US/WhoaGlow/57279_CLOSED_R.jpg?sfrm=png&sw=600&q=90",
                category: "skincare",
                skinType: ["All", "Combination", "Normal", "Dry", "Oily"],
                coverage: null,
                productType: "sunscreen",
                routineStep: "morning",
                applicationOrder: 4,
                usage: "Apply as the last step of your morning skincare routine. Reapply every 2 hours when exposed to sun.",
                benefits: ["SPF 30 protection", "glowy finish", "lightweight", "no white cast"],
                keyIngredients: ["zinc oxide", "hyaluronic acid", "squalane"],
                concerns: ["sun protection", "aging prevention", "hyperpigmentation"],
                similarTo: [
                    { brand: "Supergoop", product: "Glowscreen SPF 40", price: 38 },
                    { brand: "Drunk Elephant", product: "Umbra Sheer Physical Daily Defense", price: 34 }
                ]
            },
            // === MAKEUP - PRIMERS ===
            {
                id: "power-grip-primer",
                name: "Power Grip Primer",
                price: 11,
                rating: 4.7,
                reviews: 5140,
                badge: "Holy Grail",
                badgeColor: "text-black",
                badgeStyle: "background-color: #4ADE80;",
                shades: [],
                cta: "ADD TO BAG",
                image: "https://www.elfcosmetics.com/dw/image/v2/BBXC_PRD/on/demandware.static/-/Sites-elf-master/default/dwed6a3b79/2021/82846_OpenA_R.jpg?sfrm=png&sw=600&q=90",
                category: "makeup",
                skinType: ["Oily", "Combination", "Normal"],
                coverage: null,
                productType: "primer",
                routineStep: "morning",
                applicationOrder: 5,
                usage: "Apply a thin layer to clean, moisturized skin. Wait 30 seconds before applying foundation for best grip.",
                benefits: ["long-wear", "pore-minimizing", "gripping formula", "hydrating"],
                keyIngredients: ["hyaluronic acid", "niacinamide", "squalane"],
                concerns: ["makeup longevity", "large pores", "oily skin"],
                similarTo: [
                    { brand: "Milk Makeup", product: "Hydro Grip Primer", price: 36 },
                    { brand: "Tatcha", product: "Liquid Silk Canvas", price: 52 }
                ]
            },
            {
                id: "poreless-putty-primer",
                name: "Poreless Putty Primer",
                price: 10,
                rating: 4.6,
                reviews: 8200,
                badge: "Viral Hit",
                badgeColor: "text-black",
                badgeStyle: "background-color: #F472B6;",
                shades: [],
                cta: "ADD TO BAG",
                image: "https://www.elfcosmetics.com/dw/image/v2/BBXC_PRD/on/demandware.static/-/Sites-elf-master/default/dw79f0a7c1/2019/85912_OpenA_R.jpg?sfrm=png&sw=600&q=90",
                category: "makeup",
                skinType: ["Oily", "Combination"],
                coverage: null,
                productType: "primer",
                routineStep: "morning",
                applicationOrder: 5,
                usage: "Warm between fingers and press into skin, focusing on pores and texture. Works best on oily areas.",
                benefits: ["pore-blurring", "mattifying", "smooth finish", "long-wear"],
                keyIngredients: ["squalane", "vitamin E"],
                concerns: ["large pores", "oily skin", "texture"],
                similarTo: [
                    { brand: "Tatcha", product: "The Silk Canvas Primer", price: 52 },
                    { brand: "Benefit", product: "POREfessional Primer", price: 35 }
                ]
            },
            // === MAKEUP - FOUNDATIONS & SKIN TINTS ===
            {
                id: "halo-glow-liquid-filter",
                name: "Halo Glow Liquid Filter",
                price: 14,
                rating: 4.8,
                reviews: 9500,
                badge: "Viral Holy Grail",
                badgeColor: "text-white",
                badgeStyle: "background-color: #FACC15;",
                shades: ["#F3E5DC", "#E6Ccb2", "#D2B48C", "#8B4513"],
                cta: "SELECT SHADE",
                image: "https://www.elfcosmetics.com/dw/image/v2/BBXC_PRD/on/demandware.static/-/Sites-elf-master/default/dw2aabd9eb/2022/HaloGlowLiquidFilter/82113_Halo_Glow_Liquid_Filter_Fair/82113_OpenA_R.jpg?sfrm=png&sw=600&q=90",
                category: "makeup",
                skinType: ["Dry", "Normal", "Combination"],
                coverage: "Sheer / Natural",
                productType: "skin-tint",
                routineStep: "morning",
                applicationOrder: 6,
                usage: "Apply with fingers or a damp sponge for a natural, lit-from-within glow. Can be worn alone or mixed with foundation.",
                benefits: ["radiant finish", "natural coverage", "hydrating", "blurring"],
                keyIngredients: ["squalane", "hyaluronic acid"],
                concerns: ["dullness", "uneven skin tone", "dry skin"],
                similarTo: [
                    { brand: "Charlotte Tilbury", product: "Hollywood Flawless Filter", price: 49 },
                    { brand: "Armani", product: "Luminous Silk Primer", price: 45 }
                ]
            },
            {
                id: "soft-glam-foundation",
                name: "Soft Glam Satin Foundation",
                price: 9,
                rating: 4.4,
                reviews: 4200,
                badge: "Satin Finish",
                badgeColor: "text-white",
                badgeStyle: "background-color: #000000;",
                shades: ["#FFE4C4", "#DEB887", "#8B4513", "#2F1B15"],
                cta: "SELECT SHADE",
                image: "https://www.elfcosmetics.com/dw/image/v2/BBXC_PRD/on/demandware.static/-/Sites-elf-master/default/dwb303949d/2024/SoftGlamSatinFoundation/Medium/84948_Open_A_v3_R.jpg?sfrm=png&sw=600&q=90",
                category: "makeup",
                skinType: ["Oily", "Combination", "Normal"],
                coverage: "Medium",
                productType: "foundation",
                routineStep: "morning",
                applicationOrder: 6,
                usage: "Apply with a brush or sponge, building coverage where needed. Set with powder for longer wear.",
                benefits: ["buildable coverage", "satin finish", "lightweight", "natural look"],
                keyIngredients: ["hyaluronic acid", "squalane"],
                concerns: ["uneven skin tone", "redness", "blemishes"],
                similarTo: [
                    { brand: "Maybelline", product: "Fit Me Dewy + Smooth", price: 10 },
                    { brand: "NARS", product: "Sheer Glow Foundation", price: 49 }
                ]
            },
            {
                id: "camo-cc-cream",
                name: "Camo CC Cream SPF 30",
                price: 16,
                rating: 4.3,
                reviews: 3100,
                badge: "SPF 30",
                badgeColor: "text-white",
                badgeStyle: "background-color: #4ADE80;",
                shades: ["#F3E5DC", "#E6Ccb2", "#D2B48C", "#A0522D"],
                cta: "SELECT SHADE",
                image: "https://www.elfcosmetics.com/dw/image/v2/BBXC_PRD/on/demandware.static/-/Sites-elf-master/default/dwb303949d/2024/SoftGlamSatinFoundation/Medium/84948_Open_A_v3_R.jpg?sfrm=png&sw=600&q=90",
                category: "makeup",
                skinType: ["Combination", "Normal"],
                coverage: "Medium",
                productType: "cc-cream",
                routineStep: "morning",
                applicationOrder: 6,
                usage: "Apply with fingers or brush for a skin-perfecting finish. No need for separate SPF!",
                benefits: ["color correcting", "SPF protection", "hydrating", "buildable"],
                keyIngredients: ["niacinamide", "hyaluronic acid", "zinc oxide"],
                concerns: ["uneven skin tone", "redness", "sun protection"],
                similarTo: [
                    { brand: "IT Cosmetics", product: "CC+ Cream SPF 50", price: 47 },
                    { brand: "Erborian", product: "CC Cream", price: 44 }
                ]
            },
            // === MAKEUP - CONCEALERS ===
            {
                id: "16hr-camo-concealer",
                name: "16HR Camo Concealer",
                price: 7,
                rating: 4.5,
                reviews: 18000,
                badge: "Full Coverage",
                badgeColor: "text-white",
                badgeStyle: "background-color: #000000;",
                shades: ["#F5DEB3", "#D2B48C", "#A0522D", "#8B4513"],
                cta: "SELECT SHADE",
                image: "https://www.elfcosmetics.com/dw/image/v2/BBXC_PRD/on/demandware.static/-/Sites-elf-master/default/dw4776474c/2020/85849_OpenA_R.jpg?sfrm=png&sw=600&q=90",
                category: "makeup",
                skinType: ["Oily", "Combination"],
                coverage: "Full Coverage",
                productType: "concealer",
                routineStep: "morning",
                applicationOrder: 7,
                usage: "Apply to under-eyes, blemishes, and areas needing coverage. Blend quickly with sponge or brush.",
                benefits: ["full coverage", "long-wear", "matte finish", "crease-proof"],
                keyIngredients: ["kaolin clay", "vitamin E"],
                concerns: ["dark circles", "blemishes", "redness", "oily skin"],
                similarTo: [
                    { brand: "Tarte", product: "Shape Tape Concealer", price: 30 },
                    { brand: "Too Faced", product: "Born This Way Super Coverage Concealer", price: 33 }
                ]
            },
            {
                id: "hydrating-camo-concealer",
                name: "Hydrating Camo Concealer",
                price: 7,
                rating: 4.6,
                reviews: 15300,
                badge: "Fan Fave",
                badgeColor: "text-white",
                badgeStyle: "background-color: #4ADE80;",
                shades: ["#F5DEB3", "#D2B48C", "#A0522D"],
                cta: "SELECT SHADE",
                image: "https://www.elfcosmetics.com/dw/image/v2/BBXC_PRD/on/demandware.static/-/Sites-elf-master/default/dw898647f0/2020/84833_Open_A_R.jpg?sfrm=png&sw=600&q=90",
                category: "makeup",
                skinType: ["Dry", "Normal"],
                coverage: "Medium",
                productType: "concealer",
                routineStep: "morning",
                applicationOrder: 7,
                usage: "Apply to under-eyes and blend with finger or sponge. Layer for more coverage without caking.",
                benefits: ["hydrating", "brightening", "crease-resistant", "natural finish"],
                keyIngredients: ["hyaluronic acid", "rose hip oil", "vitamin E"],
                concerns: ["dark circles", "dry under-eyes", "fine lines"],
                similarTo: [
                    { brand: "NARS", product: "Radiant Creamy Concealer", price: 31 },
                    { brand: "Maybelline", product: "Instant Age Rewind Concealer", price: 11 }
                ]
            },
            // === MAKEUP - CONTOUR & BRONZER ===
            {
                id: "halo-glow-contour-wand",
                name: "Halo Glow Contour Beauty Wand",
                price: 9,
                rating: 4.7,
                reviews: 4500,
                badge: "Sell Out Risk",
                badgeColor: "text-white",
                badgeStyle: "background-color: #F472B6;",
                shades: ["#8B4513", "#A0522D"],
                cta: "SELECT SHADE",
                image: "https://www.elfcosmetics.com/dw/image/v2/BBXC_PRD/on/demandware.static/-/Sites-elf-master/default/dwb5b892b8/2023/HaloGlowWandContour/84706_OpenA_R.jpg?sfrm=png&sw=600&q=90",
                category: "makeup",
                skinType: ["All", "Combination", "Normal", "Dry", "Oily"],
                coverage: null,
                productType: "contour",
                routineStep: "morning",
                applicationOrder: 8,
                usage: "Apply to hollows of cheeks, jawline, and temples. Blend with sponge or brush for a natural shadow.",
                benefits: ["buildable", "blendable", "natural contour", "cushion applicator"],
                keyIngredients: ["squalane", "vitamin E"],
                concerns: ["face sculpting", "definition"],
                similarTo: [
                    { brand: "Charlotte Tilbury", product: "Hollywood Contour Wand", price: 40 },
                    { brand: "Rare Beauty", product: "Warm Wishes Bronzer Stick", price: 26 }
                ]
            },
            // === MAKEUP - BLUSH ===
            {
                id: "putty-blush",
                name: "Putty Blush",
                price: 6,
                rating: 4.5,
                reviews: 6800,
                badge: null,
                badgeColor: null,
                badgeStyle: null,
                shades: ["#FFB6C1", "#FF69B4", "#DC143C"],
                cta: "SELECT SHADE",
                image: "https://www.elfcosmetics.com/dw/image/v2/BBXC_PRD/on/demandware.static/-/Sites-elf-master/default/dwef52e28d/2020/81622_FCBLU_OpenA_R.jpg?sfrm=png&sw=600&q=90",
                category: "makeup",
                skinType: ["Oily", "Combination", "Normal"],
                coverage: null,
                productType: "blush",
                routineStep: "morning",
                applicationOrder: 9,
                usage: "Warm between fingers and tap onto cheeks. Build for more intensity. Works on eyes and lips too!",
                benefits: ["natural flush", "buildable", "multi-use", "long-lasting"],
                keyIngredients: ["squalane", "vitamin E"],
                concerns: ["adding color", "healthy glow"],
                similarTo: [
                    { brand: "Glossier", product: "Cloud Paint", price: 20 },
                    { brand: "Rare Beauty", product: "Soft Pinch Liquid Blush", price: 23 }
                ]
            },
            {
                id: "monochromatic-multi-stick",
                name: "Monochromatic Multi Stick",
                price: 5,
                rating: 4.4,
                reviews: 2100,
                badge: "Best Value",
                badgeColor: "text-white",
                badgeStyle: "background-color: #FACC15;",
                shades: ["#D87093", "#CD5C5C", "#E9967A"],
                cta: "SELECT SHADE",
                image: "https://www.elfcosmetics.com/dw/image/v2/BBXC_PRD/on/demandware.static/-/Sites-elf-master/default/dwb983b949/2025/BSGATEDBUNDLES/gripgoalscode.jpg?sw=600&q=90",
                category: "makeup",
                skinType: ["All", "Combination", "Normal", "Dry", "Oily"],
                coverage: null,
                productType: "blush",
                routineStep: "morning",
                applicationOrder: 9,
                usage: "Apply directly to cheeks, lips, and eyes. Blend with fingers for a cohesive, effortless look.",
                benefits: ["multi-use", "portable", "buildable", "creamy formula"],
                keyIngredients: ["vitamin E", "jojoba oil"],
                concerns: ["easy application", "travel-friendly", "cohesive look"],
                similarTo: [
                    { brand: "ILIA", product: "Multi-Stick", price: 34 },
                    { brand: "Nudestix", product: "Nudies Matte Blush", price: 30 }
                ]
            },
            // === MAKEUP - EYES ===
            {
                id: "bite-size-eyeshadow",
                name: "Bite-Size Eyeshadow",
                price: 3,
                rating: 4.4,
                reviews: 11200,
                badge: null,
                badgeColor: null,
                badgeStyle: null,
                shades: [],
                cta: "SELECT SHADE",
                image: "https://www.elfcosmetics.com/dw/image/v2/BBXC_PRD/on/demandware.static/-/Sites-elf-master/default/dw550b5964/2025/BiteSizeEyeshadow_ShadeExts/21192_OpenA_V2_R.jpg?sfrm=png&sw=600&q=90",
                category: "makeup",
                skinType: ["All", "Normal"],
                coverage: null,
                productType: "eyeshadow",
                routineStep: "morning",
                applicationOrder: 10,
                usage: "Apply with brush or finger. Use lighter shades on lid and darker shades in crease for dimension.",
                benefits: ["pigmented", "blendable", "curated palettes", "travel-friendly"],
                keyIngredients: ["vitamin E"],
                concerns: ["eye makeup", "easy looks"],
                similarTo: [
                    { brand: "ColourPop", product: "Pressed Powder Shadow", price: 5 },
                    { brand: "Urban Decay", product: "Naked Petite Heat", price: 29 }
                ]
            },
            {
                id: "instant-lift-brow",
                name: "Instant Lift Brow Pencil",
                price: 3,
                rating: 4.5,
                reviews: 8900,
                badge: null,
                badgeColor: null,
                badgeStyle: null,
                shades: [],
                cta: "SELECT SHADE",
                image: "https://www.elfcosmetics.com/dw/image/v2/BBXC_PRD/on/demandware.static/-/Sites-elf-master/default/dw391ec05c/2025/NoBudgeRetractableEyeliner_ShadeEXT/81330/81330_OpenA_V2_R.jpg?sfrm=png&sw=600&q=90",
                category: "makeup",
                skinType: ["All", "Normal"],
                coverage: null,
                productType: "brow-pencil",
                routineStep: "morning",
                applicationOrder: 11,
                usage: "Use short, hair-like strokes to fill in sparse areas. Brush through with spoolie for natural finish.",
                benefits: ["natural finish", "easy to use", "dual-ended", "long-lasting"],
                keyIngredients: ["vitamin E", "castor oil"],
                concerns: ["sparse brows", "definition"],
                similarTo: [
                    { brand: "Anastasia Beverly Hills", product: "Brow Wiz", price: 25 },
                    { brand: "NYX", product: "Micro Brow Pencil", price: 11 }
                ]
            },
            {
                id: "lash-it-loud-mascara",
                name: "Lash It Loud Mascara",
                price: 6,
                rating: 4.3,
                reviews: 3400,
                badge: null,
                badgeColor: null,
                badgeStyle: null,
                shades: [],
                cta: "ADD TO BAG",
                image: "https://www.elfcosmetics.com/dw/image/v2/BBXC_PRD/on/demandware.static/-/Sites-elf-master/default/dwf03400f7/2023/LashNRollMascara/83071_OPEN_A_R.jpg?sfrm=png&sw=600&q=90",
                category: "makeup",
                skinType: ["All", "Normal"],
                coverage: null,
                productType: "mascara",
                routineStep: "morning",
                applicationOrder: 12,
                usage: "Wiggle wand at base of lashes and pull through to tips. Layer for more volume and length.",
                benefits: ["volumizing", "lengthening", "buildable", "no clumping"],
                keyIngredients: ["vitamin E", "castor oil"],
                concerns: ["short lashes", "volume", "length"],
                similarTo: [
                    { brand: "Maybelline", product: "Lash Sensational", price: 10 },
                    { brand: "Benefit", product: "They're Real! Mascara", price: 28 }
                ]
            },
            // === MAKEUP - LIPS ===
            {
                id: "glow-reviver-lip-oil",
                name: "Glow Reviver Lip Oil",
                price: 9,
                rating: 4.7,
                reviews: 3824,
                badge: "Trending",
                badgeColor: "text-white",
                badgeStyle: "background-color: #F472B6;",
                shades: ["#8B4513", "#D2691E", "#CD853F", "#F4A460"],
                cta: "SELECT SHADE",
                image: "https://www.elfcosmetics.com/dw/image/v2/BBXC_PRD/on/demandware.static/-/Sites-elf-master/default/dwa20e9884/2025/GlowReviverMeltingLipBalm/84808/84808_OpenA_R.jpg?sfrm=png&sw=600&q=90",
                category: "makeup",
                skinType: ["All", "Dry", "Normal"],
                coverage: null,
                productType: "lip-oil",
                routineStep: "both",
                applicationOrder: 13,
                usage: "Apply directly to lips for a glossy, hydrating finish. Reapply as needed throughout the day.",
                benefits: ["hydrating", "glossy finish", "nourishing", "non-sticky"],
                keyIngredients: ["jojoba oil", "vitamin E", "apricot oil"],
                concerns: ["dry lips", "lip hydration", "glossy look"],
                similarTo: [
                    { brand: "Dior", product: "Lip Glow Oil", price: 40 },
                    { brand: "Kosas", product: "Wet Lip Oil Gloss", price: 26 }
                ]
            },
            {
                id: "o-face-satin-lipstick",
                name: "O Face Satin Lipstick",
                price: 9,
                rating: 4.6,
                reviews: 5200,
                badge: null,
                badgeColor: null,
                badgeStyle: null,
                shades: ["#DC143C", "#8B0000", "#FF69B4", "#FF1493"],
                cta: "SELECT SHADE",
                image: "https://www.elfcosmetics.com/dw/image/v2/BBXC_PRD/on/demandware.static/-/Sites-elf-master/default/dw3873c95a/2025/GRSLIPSTICK/83303_OpenA_V5_R.jpg?sfrm=png&sw=600&q=90",
                category: "makeup",
                skinType: ["All", "Normal"],
                coverage: null,
                productType: "lipstick",
                routineStep: "morning",
                applicationOrder: 13,
                usage: "Apply directly from the bullet or with a lip brush for precision. Blot and reapply for longer wear.",
                benefits: ["satin finish", "pigmented", "comfortable wear", "hydrating"],
                keyIngredients: ["vitamin E", "shea butter", "jojoba oil"],
                concerns: ["lip color", "comfortable formula"],
                similarTo: [
                    { brand: "MAC", product: "Satin Lipstick", price: 23 },
                    { brand: "Charlotte Tilbury", product: "Matte Revolution Lipstick", price: 35 }
                ]
            },
            // === MORE EYES PRODUCTS ===
            {
                id: "liquid-glitter-eyeliner",
                name: "Liquid Glitter Eyeliner",
                price: 5,
                rating: 4.3,
                reviews: 2800,
                badge: "Glitter",
                badgeColor: "text-white",
                badgeStyle: "background-color: #F472B6;",
                shades: ["#FFD700", "#C0C0C0", "#8B4513"],
                cta: "SELECT SHADE",
                image: "https://www.elfcosmetics.com/dw/image/v2/BBXC_PRD/on/demandware.static/-/Sites-elf-master/default/dwec1a25b4/2025/GlitzshowEyeshadowStick/83795_OpenA_V2_R.jpg?sfrm=png&sw=600&q=90",
                category: "makeup",
                skinType: ["All", "Normal"],
                coverage: null,
                productType: "eyeliner",
                routineStep: "morning",
                applicationOrder: 11,
                usage: "Apply along lash line or over eyeshadow for a sparkly accent. Let dry completely before opening eyes.",
                benefits: ["glittery", "long-lasting", "precise tip", "party-ready"],
                keyIngredients: ["vitamin E"],
                concerns: ["eye definition", "sparkle"],
                similarTo: [
                    { brand: "Stila", product: "Glitter & Glow Liquid Eye Shadow", price: 24 },
                    { brand: "NYX", product: "Glitter Goals Liquid Liner", price: 9 }
                ]
            },
            {
                id: "no-budge-shadow-stick",
                name: "No Budge Shadow Stick",
                price: 4,
                rating: 4.5,
                reviews: 6400,
                badge: "Cream Shadow",
                badgeColor: "text-white",
                badgeStyle: "background-color: #4ADE80;",
                shades: ["#D4AF37", "#8B7355", "#2F4F4F"],
                cta: "SELECT SHADE",
                image: "https://www.elfcosmetics.com/dw/image/v2/BBXC_PRD/on/demandware.static/-/Sites-elf-master/default/dw550b5964/2025/BiteSizeEyeshadow_ShadeExts/21192_OpenA_V2_R.jpg?sfrm=png&sw=600&q=90",
                category: "makeup",
                skinType: ["All", "Normal", "Oily"],
                coverage: null,
                productType: "eyeshadow",
                routineStep: "morning",
                applicationOrder: 10,
                usage: "Swipe directly onto lids and blend with fingertip. Can be used alone or as a base for powder shadow.",
                benefits: ["cream-to-powder", "waterproof", "crease-proof", "blendable"],
                keyIngredients: ["vitamin E", "jojoba oil"],
                concerns: ["creasing", "long-wear"],
                similarTo: [
                    { brand: "Laura Mercier", product: "Caviar Stick Eye Colour", price: 32 },
                    { brand: "Charlotte Tilbury", product: "Eyes to Mesmerize", price: 32 }
                ]
            },
            {
                id: "H2O-proof-eyeliner-pen",
                name: "H2O Proof Eyeliner Pen",
                price: 3,
                rating: 4.6,
                reviews: 8900,
                badge: "Waterproof",
                badgeColor: "text-white",
                badgeStyle: "background-color: #000000;",
                shades: [],
                cta: "ADD TO BAG",
                image: "https://www.elfcosmetics.com/dw/image/v2/BBXC_PRD/on/demandware.static/-/Sites-elf-master/default/dwb1d40603/21652_SILO.jpg?sfrm=png&sw=600&q=90",
                category: "makeup",
                skinType: ["All", "Normal", "Oily"],
                coverage: null,
                productType: "eyeliner",
                routineStep: "morning",
                applicationOrder: 11,
                usage: "Draw along lash line starting from inner corner. Wing out at outer corner for cat-eye look.",
                benefits: ["waterproof", "smudge-proof", "precise felt tip", "intense black"],
                keyIngredients: ["vitamin E"],
                concerns: ["eye definition", "waterproof makeup"],
                similarTo: [
                    { brand: "Stila", product: "Stay All Day Waterproof Liquid Liner", price: 24 },
                    { brand: "KVD", product: "Tattoo Liner", price: 23 }
                ]
            },
            {
                id: "lid-laminate-eye-primer",
                name: "Lid Laminate Eye Primer",
                price: 7,
                rating: 4.4,
                reviews: 3200,
                badge: null,
                badgeColor: null,
                badgeStyle: null,
                shades: [],
                cta: "ADD TO BAG",
                image: "https://www.elfcosmetics.com/dw/image/v2/BBXC_PRD/on/demandware.static/-/Sites-elf-master/default/dw2752241f/2025/IncrediCurlMascara/85170_OpenA_V3_R.jpg?sfrm=png&sw=600&q=90",
                category: "makeup",
                skinType: ["All", "Normal", "Oily"],
                coverage: null,
                productType: "eye-primer",
                routineStep: "morning",
                applicationOrder: 9,
                usage: "Apply thin layer to lids before eyeshadow. Blend with finger and let set for 30 seconds.",
                benefits: ["crease-proof", "color-intensifying", "long-wear", "smooth base"],
                keyIngredients: ["vitamin E", "niacinamide"],
                concerns: ["creasing", "shadow longevity", "color vibrancy"],
                similarTo: [
                    { brand: "Urban Decay", product: "Eyeshadow Primer Potion", price: 27 },
                    { brand: "NARS", product: "Pro-Prime Smudge Proof Eyeshadow Base", price: 28 }
                ]
            },
            {
                id: "expert-liquid-liner",
                name: "Expert Liquid Liner",
                price: 3,
                rating: 4.5,
                reviews: 7200,
                badge: "Best Value",
                badgeColor: "text-white",
                badgeStyle: "background-color: #FACC15;",
                shades: [],
                cta: "ADD TO BAG",
                image: "https://www.elfcosmetics.com/dw/image/v2/BBXC_PRD/on/demandware.static/-/Sites-elf-master/default/dw862f4e62/21702_SILO2.jpg?sfrm=png&sw=600&q=90",
                category: "makeup",
                skinType: ["All", "Normal"],
                coverage: null,
                productType: "eyeliner",
                routineStep: "morning",
                applicationOrder: 11,
                usage: "Use the fine-tip brush to create thin to bold lines. Perfect for winged liner looks.",
                benefits: ["precise application", "long-lasting", "matte finish", "easy to use"],
                keyIngredients: ["vitamin E"],
                concerns: ["eye definition", "winged liner"],
                similarTo: [
                    { brand: "Maybelline", product: "Master Precise Liquid Liner", price: 10 },
                    { brand: "NYX", product: "Epic Ink Liner", price: 9 }
                ]
            },
            {
                id: "metallic-flare-eyeliner",
                name: "Metallic Flare Eyeliner",
                price: 4,
                rating: 4.3,
                reviews: 2100,
                badge: "Metallic",
                badgeColor: "text-white",
                badgeStyle: "background-color: #F472B6;",
                shades: ["#FFD700", "#C0C0C0", "#CD7F32"],
                cta: "SELECT SHADE",
                image: "https://www.elfcosmetics.com/dw/image/v2/BBXC_PRD/on/demandware.static/-/Sites-elf-master/default/dw391ec05c/2025/NoBudgeRetractableEyeliner_ShadeEXT/81330/81330_OpenA_V2_R.jpg?sfrm=png&sw=600&q=90",
                category: "makeup",
                skinType: ["All", "Normal"],
                coverage: null,
                productType: "eyeliner",
                routineStep: "morning",
                applicationOrder: 11,
                usage: "Apply to inner corners to brighten eyes or along lash line for a metallic pop.",
                benefits: ["metallic finish", "buildable", "smooth application", "dimensional"],
                keyIngredients: ["vitamin E"],
                concerns: ["eye brightening", "metallic look"],
                similarTo: [
                    { brand: "Marc Jacobs", product: "Highliner Gel Eye Crayon", price: 27 },
                    { brand: "Urban Decay", product: "24/7 Glide-On Eye Pencil", price: 24 }
                ]
            },
            {
                id: "cream-glide-eye-pencil",
                name: "Cream Glide Eye Pencil",
                price: 2,
                rating: 4.4,
                reviews: 5800,
                badge: null,
                badgeColor: null,
                badgeStyle: null,
                shades: ["#000000", "#8B4513", "#191970"],
                cta: "SELECT SHADE",
                image: "https://www.elfcosmetics.com/dw/image/v2/BBXC_PRD/on/demandware.static/-/Sites-elf-master/default/dw391ec05c/2025/NoBudgeRetractableEyeliner_ShadeEXT/81330/81330_OpenA_V2_R.jpg?sfrm=png&sw=600&q=90",
                category: "makeup",
                skinType: ["All", "Normal"],
                coverage: null,
                productType: "eyeliner",
                routineStep: "morning",
                applicationOrder: 11,
                usage: "Line upper and lower lash lines. Smudge with finger or brush for a smoky effect.",
                benefits: ["creamy texture", "easy to smudge", "long-wearing", "buildable"],
                keyIngredients: ["vitamin E", "jojoba oil"],
                concerns: ["eye definition", "smoky eyes"],
                similarTo: [
                    { brand: "Bobbi Brown", product: "Perfectly Defined Long-Wear Eye Pencil", price: 32 },
                    { brand: "MAC", product: "Eye Kohl", price: 20 }
                ]
            },
            {
                id: "big-mood-mascara",
                name: "Big Mood Mascara",
                price: 7,
                rating: 4.6,
                reviews: 4900,
                badge: "Volumizing",
                badgeColor: "text-white",
                badgeStyle: "background-color: #000000;",
                shades: [],
                cta: "ADD TO BAG",
                image: "https://www.elfcosmetics.com/dw/image/v2/BBXC_PRD/on/demandware.static/-/Sites-elf-master/default/dw2752241f/2025/IncrediCurlMascara/85170_OpenA_V3_R.jpg?sfrm=png&sw=600&q=90",
                category: "makeup",
                skinType: ["All", "Normal"],
                coverage: null,
                productType: "mascara",
                routineStep: "morning",
                applicationOrder: 12,
                usage: "Wiggle wand at roots and sweep through to tips. Apply multiple coats for drama.",
                benefits: ["extreme volume", "lengthening", "dramatic", "clump-free"],
                keyIngredients: ["vitamin E", "panthenol"],
                concerns: ["volume", "dramatic lashes"],
                similarTo: [
                    { brand: "Too Faced", product: "Better Than Sex Mascara", price: 29 },
                    { brand: "Benefit", product: "They're Real! Lengthening Mascara", price: 28 }
                ]
            },
            {
                id: "lash-n-roll-mascara",
                name: "Lash 'n Roll Mascara",
                price: 6,
                rating: 4.5,
                reviews: 3600,
                badge: "Curling",
                badgeColor: "text-white",
                badgeStyle: "background-color: #000000;",
                shades: [],
                cta: "ADD TO BAG",
                image: "https://www.elfcosmetics.com/dw/image/v2/BBXC_PRD/on/demandware.static/-/Sites-elf-master/default/dwf03400f7/2023/LashNRollMascara/83071_OPEN_A_R.jpg?sfrm=png&sw=600&q=90",
                category: "makeup",
                skinType: ["All", "Normal"],
                coverage: null,
                productType: "mascara",
                routineStep: "morning",
                applicationOrder: 12,
                usage: "Sweep wand from roots to tips in an upward motion. Holds curl all day.",
                benefits: ["curling", "lifting", "lengthening", "smudge-proof"],
                keyIngredients: ["vitamin E", "rice bran wax"],
                concerns: ["straight lashes", "curl hold", "length"],
                similarTo: [
                    { brand: "L'Oreal", product: "Voluminous Lash Paradise", price: 12 },
                    { brand: "Clinique", product: "High Impact Curling Mascara", price: 23 }
                ]
            },
            {
                id: "16hr-shadow-palette-rose-gold",
                name: "16HR Shadow Palette - Rose Gold",
                price: 10,
                rating: 4.7,
                reviews: 5200,
                badge: "Long-Wear",
                badgeColor: "text-white",
                badgeStyle: "background-color: #000000;",
                shades: [],
                cta: "ADD TO BAG",
                image: "https://www.elfcosmetics.com/dw/image/v2/BBXC_PRD/on/demandware.static/-/Sites-elf-master/default/dw550b5964/2025/BiteSizeEyeshadow_ShadeExts/21192_OpenA_V2_R.jpg?sfrm=png&sw=600&q=90",
                category: "makeup",
                skinType: ["All", "Normal"],
                coverage: null,
                productType: "eyeshadow",
                routineStep: "morning",
                applicationOrder: 10,
                usage: "Apply matte shades for definition, shimmer shades for highlight. Blend seamlessly with brush.",
                benefits: ["16-hour wear", "highly pigmented", "blendable", "matte & shimmer"],
                keyIngredients: ["vitamin E"],
                concerns: ["eye makeup", "long wear", "versatile looks"],
                similarTo: [
                    { brand: "Huda Beauty", product: "Rose Gold Remastered Palette", price: 65 },
                    { brand: "Anastasia Beverly Hills", product: "Soft Glam Palette", price: 45 }
                ]
            },
            // === MORE LIPS PRODUCTS ===
            {
                id: "sheer-slick-lipstick",
                name: "Sheer Slick Lipstick",
                price: 6,
                rating: 4.5,
                reviews: 4100,
                badge: "Sheer",
                badgeColor: "text-white",
                badgeStyle: "background-color: #F472B6;",
                shades: ["#FFB6C1", "#FF69B4", "#DC143C", "#8B0000"],
                cta: "SELECT SHADE",
                image: "https://www.elfcosmetics.com/dw/image/v2/BBXC_PRD/on/demandware.static/-/Sites-elf-master/default/dw3873c95a/2025/GRSLIPSTICK/83303_OpenA_V5_R.jpg?sfrm=png&sw=600&q=90",
                category: "makeup",
                skinType: ["All", "Dry", "Normal"],
                coverage: null,
                productType: "lipstick",
                routineStep: "both",
                applicationOrder: 13,
                usage: "Swipe on for a wash of color with a glossy finish. Reapply throughout the day.",
                benefits: ["sheer coverage", "glossy", "hydrating", "buildable"],
                keyIngredients: ["vitamin E", "coconut oil", "shea butter"],
                concerns: ["lip hydration", "natural look", "glossy finish"],
                similarTo: [
                    { brand: "Clinique", product: "Almost Lipstick", price: 22 },
                    { brand: "Bobbi Brown", product: "Extra Lip Tint", price: 32 }
                ]
            },
            {
                id: "liquid-matte-lipstick",
                name: "Liquid Matte Lipstick",
                price: 7,
                rating: 4.4,
                reviews: 6800,
                badge: "Matte",
                badgeColor: "text-white",
                badgeStyle: "background-color: #000000;",
                shades: ["#DC143C", "#8B0000", "#FF1493", "#8B4513"],
                cta: "SELECT SHADE",
                image: "https://www.elfcosmetics.com/dw/image/v2/BBXC_PRD/on/demandware.static/-/Sites-elf-master/default/dw0a232b51/2025/GlossyLipStainEXT/81991_OpenA_V2_R_R.jpg?sfrm=png&sw=600&q=90",
                category: "makeup",
                skinType: ["All", "Normal", "Oily"],
                coverage: null,
                productType: "lipstick",
                routineStep: "morning",
                applicationOrder: 13,
                usage: "Apply with applicator starting from center of lips. Let dry for long-lasting matte finish.",
                benefits: ["liquid-to-matte", "long-wearing", "highly pigmented", "transfer-proof"],
                keyIngredients: ["vitamin E"],
                concerns: ["lip color", "long wear", "matte finish"],
                similarTo: [
                    { brand: "Stila", product: "Stay All Day Liquid Lipstick", price: 24 },
                    { brand: "Anastasia Beverly Hills", product: "Liquid Lipstick", price: 20 }
                ]
            },
            {
                id: "lip-plumping-gloss",
                name: "Lip Plumping Gloss",
                price: 8,
                rating: 4.3,
                reviews: 3400,
                badge: "Plumping",
                badgeColor: "text-white",
                badgeStyle: "background-color: #F472B6;",
                shades: ["#FFB6C1", "#FF69B4", "#DC143C"],
                cta: "SELECT SHADE",
                image: "https://www.elfcosmetics.com/dw/image/v2/BBXC_PRD/on/demandware.static/-/Sites-elf-master/default/dw1218c1df/2023/PoutCloutLipPlumpingPen/PinkyOut/82292_OpenA_V3_R.jpg?sfrm=png&sw=600&q=90",
                category: "makeup",
                skinType: ["All", "Dry", "Normal"],
                coverage: null,
                productType: "lip-gloss",
                routineStep: "both",
                applicationOrder: 13,
                usage: "Apply to clean lips or over lipstick. You may feel a slight tingling sensation.",
                benefits: ["plumping", "glossy", "tingling sensation", "volumizing"],
                keyIngredients: ["peppermint oil", "vitamin E", "hyaluronic acid"],
                concerns: ["thin lips", "lip volume", "glossy look"],
                similarTo: [
                    { brand: "Too Faced", product: "Lip Injection Extreme", price: 32 },
                    { brand: "Buxom", product: "Full-On Plumping Lip Polish", price: 22 }
                ]
            },
            {
                id: "jelly-pop-lip-gloss",
                name: "Jelly Pop Lip Gloss",
                price: 4,
                rating: 4.6,
                reviews: 5600,
                badge: "Viral Hit",
                badgeColor: "text-black",
                badgeStyle: "background-color: #F472B6;",
                shades: ["#FFB6C1", "#FF69B4", "#DC143C", "#8B4513"],
                cta: "SELECT SHADE",
                image: "https://www.elfcosmetics.com/dw/image/v2/BBXC_PRD/on/demandware.static/-/Sites-elf-master/default/dw286e5dc4/2024/GlowReviverLipOilEXT/82013_OPENA_v5_R.jpg?sfrm=png&sw=600&q=90",
                category: "makeup",
                skinType: ["All", "Dry", "Normal"],
                coverage: null,
                productType: "lip-gloss",
                routineStep: "both",
                applicationOrder: 13,
                usage: "Apply to lips for a jelly-like glossy finish. Layer for more intensity.",
                benefits: ["jelly texture", "high shine", "non-sticky", "buildable color"],
                keyIngredients: ["vitamin E", "jojoba oil"],
                concerns: ["lip shine", "glossy look", "hydration"],
                similarTo: [
                    { brand: "Fenty Beauty", product: "Gloss Bomb Universal Lip Luminizer", price: 21 },
                    { brand: "NYX", product: "Butter Gloss", price: 7 }
                ]
            },
            {
                id: "lip-liner-pencil",
                name: "Lip Liner Pencil",
                price: 3,
                rating: 4.5,
                reviews: 4200,
                badge: "Essential",
                badgeColor: "text-white",
                badgeStyle: "background-color: #000000;",
                shades: ["#8B4513", "#DC143C", "#FF69B4", "#8B0000"],
                cta: "SELECT SHADE",
                image: "https://www.elfcosmetics.com/dw/image/v2/BBXC_PRD/on/demandware.static/-/Sites-elf-master/default/dw3873c95a/2025/GRSLIPSTICK/83303_OpenA_V5_R.jpg?sfrm=png&sw=600&q=90",
                category: "makeup",
                skinType: ["All", "Normal"],
                coverage: null,
                productType: "lip-liner",
                routineStep: "morning",
                applicationOrder: 13,
                usage: "Line lips starting from cupid's bow. Fill in entire lip for longer-lasting color.",
                benefits: ["defines lips", "prevents feathering", "long-wearing", "creamy"],
                keyIngredients: ["vitamin E", "jojoba oil"],
                concerns: ["lip definition", "lip color longevity"],
                similarTo: [
                    { brand: "MAC", product: "Lip Pencil", price: 20 },
                    { brand: "NYX", product: "Slim Lip Pencil", price: 5 }
                ]
            },
            {
                id: "tinted-lip-balm",
                name: "Tinted Lip Balm SPF 15",
                price: 4,
                rating: 4.4,
                reviews: 3800,
                badge: "SPF 15",
                badgeColor: "text-white",
                badgeStyle: "background-color: #4ADE80;",
                shades: ["#FFB6C1", "#FF69B4", "#DC143C"],
                cta: "SELECT SHADE",
                image: "https://www.elfcosmetics.com/dw/image/v2/BBXC_PRD/on/demandware.static/-/Sites-elf-master/default/dwa20e9884/2025/GlowReviverMeltingLipBalm/84808/84808_OpenA_R.jpg?sfrm=png&sw=600&q=90",
                category: "makeup",
                skinType: ["All", "Dry", "Normal"],
                coverage: null,
                productType: "lip-balm",
                routineStep: "both",
                applicationOrder: 13,
                usage: "Apply throughout the day for hydration and a hint of color. Reapply after eating.",
                benefits: ["SPF protection", "hydrating", "sheer color", "nourishing"],
                keyIngredients: ["shea butter", "vitamin E", "coconut oil"],
                concerns: ["dry lips", "sun protection", "natural color"],
                similarTo: [
                    { brand: "Fresh", product: "Sugar Lip Treatment SPF 15", price: 26 },
                    { brand: "Burt's Bees", product: "Tinted Lip Balm", price: 5 }
                ]
            },
            {
                id: "glossy-lip-stain",
                name: "Glossy Lip Stain",
                price: 6,
                rating: 4.3,
                reviews: 2900,
                badge: "Long-Wear",
                badgeColor: "text-white",
                badgeStyle: "background-color: #000000;",
                shades: ["#DC143C", "#8B0000", "#FF1493"],
                cta: "SELECT SHADE",
                image: "https://www.elfcosmetics.com/dw/image/v2/BBXC_PRD/on/demandware.static/-/Sites-elf-master/default/dwa20e9884/2025/GlowReviverMeltingLipBalm/84808/84808_OpenA_R.jpg?sfrm=png&sw=600&q=90",
                category: "makeup",
                skinType: ["All", "Normal"],
                coverage: null,
                productType: "lip-stain",
                routineStep: "morning",
                applicationOrder: 13,
                usage: "Apply to center of lips and blend outward. Let set for long-lasting color with a glossy finish.",
                benefits: ["long-wearing", "glossy finish", "buildable", "lightweight"],
                keyIngredients: ["vitamin E"],
                concerns: ["lip color longevity", "natural look"],
                similarTo: [
                    { brand: "YSL", product: "Tatouage Couture Velvet Cream", price: 38 },
                    { brand: "Benefit", product: "Benetint Lip & Cheek Stain", price: 22 }
                ]
            },
            {
                id: "pout-clout-lip-plumper",
                name: "Pout Clout Lip Plumper",
                price: 9,
                rating: 4.4,
                reviews: 3100,
                badge: "Trending",
                badgeColor: "text-white",
                badgeStyle: "background-color: #F472B6;",
                shades: ["#FFB6C1", "#FF69B4"],
                cta: "SELECT SHADE",
                image: "https://www.elfcosmetics.com/dw/image/v2/BBXC_PRD/on/demandware.static/-/Sites-elf-master/default/dwa20e9884/2025/GlowReviverMeltingLipBalm/84808/84808_OpenA_R.jpg?sfrm=png&sw=600&q=90",
                category: "makeup",
                skinType: ["All", "Dry", "Normal"],
                coverage: null,
                productType: "lip-plumper",
                routineStep: "both",
                applicationOrder: 13,
                usage: "Apply to lips for an instant plumping effect. Can be worn alone or over lipstick.",
                benefits: ["instant plumping", "hydrating", "glossy", "cooling sensation"],
                keyIngredients: ["peppermint oil", "hyaluronic acid", "vitamin E"],
                concerns: ["lip volume", "thin lips", "hydration"],
                similarTo: [
                    { brand: "Dior", product: "Addict Lip Maximizer", price: 38 },
                    { brand: "Too Faced", product: "Lip Injection Glossy", price: 28 }
                ]
            },
            {
                id: "kissproof-lip-creme",
                name: "Kiss-Proof Lip Creme",
                price: 8,
                rating: 4.5,
                reviews: 4700,
                badge: "Transfer-Proof",
                badgeColor: "text-white",
                badgeStyle: "background-color: #000000;",
                shades: ["#DC143C", "#8B0000", "#FF1493", "#8B4513"],
                cta: "SELECT SHADE",
                image: "https://www.elfcosmetics.com/dw/image/v2/BBXC_PRD/on/demandware.static/-/Sites-elf-master/default/dw0a232b51/2025/GlossyLipStainEXT/81991_OpenA_V2_R_R.jpg?sfrm=png&sw=600&q=90",
                category: "makeup",
                skinType: ["All", "Normal"],
                coverage: null,
                productType: "lipstick",
                routineStep: "morning",
                applicationOrder: 13,
                usage: "Apply with applicator and let set for 60 seconds. No transfer, no budge!",
                benefits: ["transfer-proof", "long-wearing", "highly pigmented", "matte finish"],
                keyIngredients: ["vitamin E"],
                concerns: ["lip color longevity", "transfer-proof", "matte look"],
                similarTo: [
                    { brand: "Maybelline", product: "SuperStay Matte Ink", price: 11 },
                    { brand: "Fenty Beauty", product: "Stunna Lip Paint", price: 27 }
                ]
            },
            {
                id: "lip-exfoliator",
                name: "Lip Exfoliator",
                price: 4,
                rating: 4.6,
                reviews: 5100,
                badge: "Smoothing",
                badgeColor: "text-white",
                badgeStyle: "background-color: #4ADE80;",
                shades: [],
                cta: "ADD TO BAG",
                image: "https://www.elfcosmetics.com/dw/image/v2/BBXC_PRD/on/demandware.static/-/Sites-elf-master/default/dwa20e9884/2025/GlowReviverMeltingLipBalm/84808/84808_OpenA_R.jpg?sfrm=png&sw=600&q=90",
                category: "skincare",
                skinType: ["All", "Dry"],
                coverage: null,
                productType: "lip-care",
                routineStep: "evening",
                applicationOrder: 1,
                usage: "Massage onto lips in circular motions. Wipe off and follow with lip balm.",
                benefits: ["exfoliating", "smoothing", "removes dead skin", "preps lips"],
                keyIngredients: ["sugar", "vitamin E", "jojoba oil", "shea butter"],
                concerns: ["dry lips", "flaky lips", "smooth lips"],
                similarTo: [
                    { brand: "Laneige", product: "Lip Sleeping Mask", price: 24 },
                    { brand: "Sara Happ", product: "The Lip Scrub", price: 24 }
                ]
            },
            // === MORE FACE PRODUCTS ===
            {
                id: "poreless-face-primer",
                name: "Poreless Face Primer",
                price: 8,
                rating: 4.5,
                reviews: 6200,
                badge: "Pore-Blurring",
                badgeColor: "text-white",
                badgeStyle: "background-color: #4ADE80;",
                shades: [],
                cta: "ADD TO BAG",
                image: "https://www.elfcosmetics.com/dw/image/v2/BBXC_PRD/on/demandware.static/-/Sites-elf-master/default/dwed6a3b79/2021/82846_OpenA_R.jpg?sfrm=png&sw=600&q=90",
                category: "makeup",
                skinType: ["All", "Oily", "Combination"],
                coverage: null,
                productType: "primer",
                routineStep: "morning",
                applicationOrder: 5,
                usage: "Apply to pores and fine lines before foundation. Focus on T-zone for oily skin.",
                benefits: ["pore-minimizing", "mattifying", "smooth texture", "oil-control"],
                keyIngredients: ["niacinamide", "tea tree oil"],
                concerns: ["large pores", "oily skin", "texture"],
                similarTo: [
                    { brand: "Benefit", product: "The POREfessional Face Primer", price: 35 },
                    { brand: "Smashbox", product: "Photo Finish Pore Minimizing Primer", price: 42 }
                ]
            },
            {
                id: "setting-spray-mist-set",
                name: "Setting Spray - Mist & Set",
                price: 6,
                rating: 4.4,
                reviews: 7800,
                badge: "Long-Wear",
                badgeColor: "text-white",
                badgeStyle: "background-color: #000000;",
                shades: [],
                cta: "ADD TO BAG",
                image: "https://www.elfcosmetics.com/dw/image/v2/BBXC_PRD/on/demandware.static/-/Sites-elf-master/default/dw56f702a5/2024/SuntouchableUpdatedAssets_US/WhoaGlow/57279_CLOSED_R.jpg?sfrm=png&sw=600&q=90",
                category: "makeup",
                skinType: ["All", "Normal", "Oily", "Combination"],
                coverage: null,
                productType: "setting-spray",
                routineStep: "morning",
                applicationOrder: 14,
                usage: "Hold 8-10 inches from face. Mist in an X and T motion after makeup application.",
                benefits: ["long-lasting makeup", "matte finish", "controls oil", "lightweight"],
                keyIngredients: ["niacinamide", "cucumber extract"],
                concerns: ["makeup longevity", "oil control"],
                similarTo: [
                    { brand: "Urban Decay", product: "All Nighter Setting Spray", price: 35 },
                    { brand: "NYX", product: "Matte Finish Setting Spray", price: 10 }
                ]
            },
            {
                id: "dewy-setting-spray",
                name: "Dewy Setting Spray",
                price: 6,
                rating: 4.5,
                reviews: 5900,
                badge: "Glow",
                badgeColor: "text-white",
                badgeStyle: "background-color: #FACC15;",
                shades: [],
                cta: "ADD TO BAG",
                image: "https://www.elfcosmetics.com/dw/image/v2/BBXC_PRD/on/demandware.static/-/Sites-elf-master/default/dw56f702a5/2024/SuntouchableUpdatedAssets_US/WhoaGlow/57279_CLOSED_R.jpg?sfrm=png&sw=600&q=90",
                category: "makeup",
                skinType: ["All", "Dry", "Normal"],
                coverage: null,
                productType: "setting-spray",
                routineStep: "morning",
                applicationOrder: 14,
                usage: "Spray over finished makeup for a dewy, luminous glow. Can also be used throughout the day for refresh.",
                benefits: ["dewy finish", "hydrating", "radiant glow", "makeup setting"],
                keyIngredients: ["hyaluronic acid", "glycerin", "cucumber extract"],
                concerns: ["dry skin", "dewy look", "makeup setting"],
                similarTo: [
                    { brand: "MAC", product: "Fix+ Radiant Mist", price: 29 },
                    { brand: "Tatcha", product: "Luminous Dewy Skin Mist", price: 48 }
                ]
            },
            {
                id: "halo-glow-setting-powder",
                name: "Halo Glow Setting Powder",
                price: 9,
                rating: 4.3,
                reviews: 4200,
                badge: "Luminous",
                badgeColor: "text-white",
                badgeStyle: "background-color: #FACC15;",
                shades: ["#F5DEB3", "#D2B48C", "#A0522D"],
                cta: "SELECT SHADE",
                image: "https://www.elfcosmetics.com/dw/image/v2/BBXC_PRD/on/demandware.static/-/Sites-elf-master/default/dw2aabd9eb/2022/HaloGlowLiquidFilter/82113_Halo_Glow_Liquid_Filter_Fair/82113_OpenA_R.jpg?sfrm=png&sw=600&q=90",
                category: "makeup",
                skinType: ["All", "Dry", "Normal"],
                coverage: null,
                productType: "setting-powder",
                routineStep: "morning",
                applicationOrder: 14,
                usage: "Dust lightly over makeup to set while maintaining a luminous finish. Focus on T-zone.",
                benefits: ["luminous finish", "sets makeup", "not cakey", "light-reflecting"],
                keyIngredients: ["hyaluronic acid", "squalane"],
                concerns: ["setting makeup", "maintaining glow", "longevity"],
                similarTo: [
                    { brand: "Hourglass", product: "Ambient Lighting Powder", price: 50 },
                    { brand: "Laura Mercier", product: "Translucent Loose Setting Powder", price: 42 }
                ]
            },
            {
                id: "perfect-finish-hd-powder",
                name: "Perfect Finish HD Powder",
                price: 6,
                rating: 4.4,
                reviews: 8100,
                badge: "HD Finish",
                badgeColor: "text-white",
                badgeStyle: "background-color: #000000;",
                shades: [],
                cta: "ADD TO BAG",
                image: "https://www.elfcosmetics.com/dw/image/v2/BBXC_PRD/on/demandware.static/-/Sites-elf-master/default/dw2aabd9eb/2022/HaloGlowLiquidFilter/82113_Halo_Glow_Liquid_Filter_Fair/82113_OpenA_R.jpg?sfrm=png&sw=600&q=90",
                category: "makeup",
                skinType: ["All", "Normal", "Oily"],
                coverage: null,
                productType: "setting-powder",
                routineStep: "morning",
                applicationOrder: 14,
                usage: "Apply with brush or puff to set makeup. Perfect for photos with no flashback.",
                benefits: ["HD finish", "translucent", "no flashback", "mattifying"],
                keyIngredients: ["silica"],
                concerns: ["setting makeup", "photo-ready", "shine control"],
                similarTo: [
                    { brand: "RCMA", product: "No Color Powder", price: 12 },
                    { brand: "Make Up For Ever", product: "HD Pressed Powder", price: 39 }
                ]
            },
            {
                id: "baked-highlighter",
                name: "Baked Highlighter",
                price: 4,
                rating: 4.6,
                reviews: 9200,
                badge: "Best Value",
                badgeColor: "text-white",
                badgeStyle: "background-color: #FACC15;",
                shades: ["#FFD700", "#FFC0CB", "#E6E6FA"],
                cta: "SELECT SHADE",
                image: "https://www.elfcosmetics.com/dw/image/v2/BBXC_PRD/on/demandware.static/-/Sites-elf-master/default/dwb5b892b8/2023/HaloGlowWandContour/84706_OpenA_R.jpg?sfrm=png&sw=600&q=90",
                category: "makeup",
                skinType: ["All", "Normal", "Dry"],
                coverage: null,
                productType: "highlighter",
                routineStep: "morning",
                applicationOrder: 8,
                usage: "Apply to high points of face: cheekbones, brow bone, cupid's bow, and bridge of nose.",
                benefits: ["intense glow", "buildable", "smooth texture", "long-lasting"],
                keyIngredients: ["vitamin E"],
                concerns: ["adding glow", "highlighting", "dimension"],
                similarTo: [
                    { brand: "Becca", product: "Shimmering Skin Perfector Pressed", price: 38 },
                    { brand: "Fenty Beauty", product: "Killawatt Freestyle Highlighter", price: 36 }
                ]
            },
            {
                id: "putty-bronzer",
                name: "Putty Bronzer",
                price: 7,
                rating: 4.5,
                reviews: 5400,
                badge: "Viral",
                badgeColor: "text-black",
                badgeStyle: "background-color: #F472B6;",
                shades: ["#D2691E", "#8B4513", "#654321"],
                cta: "SELECT SHADE",
                image: "https://www.elfcosmetics.com/dw/image/v2/BBXC_PRD/on/demandware.static/-/Sites-elf-master/default/dwb5b892b8/2023/HaloGlowWandContour/84706_OpenA_R.jpg?sfrm=png&sw=600&q=90",
                category: "makeup",
                skinType: ["All", "Combination", "Oily"],
                coverage: null,
                productType: "bronzer",
                routineStep: "morning",
                applicationOrder: 8,
                usage: "Warm between fingers and apply to areas where sun naturally hits: forehead, cheeks, nose.",
                benefits: ["putty texture", "blendable", "natural bronze", "buildable"],
                keyIngredients: ["squalane", "vitamin E"],
                concerns: ["adding warmth", "bronzed look", "sun-kissed"],
                similarTo: [
                    { brand: "Milk Makeup", product: "Matte Bronzer", price: 30 },
                    { brand: "Fenty Beauty", product: "Sun Stalk'r Instant Warmth Bronzer", price: 32 }
                ]
            },
            {
                id: "shimmer-highlighting-powder",
                name: "Shimmer Highlighting Powder",
                price: 5,
                rating: 4.5,
                reviews: 6700,
                badge: "Shimmer",
                badgeColor: "text-white",
                badgeStyle: "background-color: #FACC15;",
                shades: ["#FFD700", "#C0C0C0", "#FFC0CB"],
                cta: "SELECT SHADE",
                image: "https://www.elfcosmetics.com/dw/image/v2/BBXC_PRD/on/demandware.static/-/Sites-elf-master/default/dwb5b892b8/2023/HaloGlowWandContour/84706_OpenA_R.jpg?sfrm=png&sw=600&q=90",
                category: "makeup",
                skinType: ["All", "Normal", "Dry"],
                coverage: null,
                productType: "highlighter",
                routineStep: "morning",
                applicationOrder: 8,
                usage: "Sweep onto high points of face with a fluffy brush for a luminous shimmer.",
                benefits: ["intense shimmer", "buildable", "silky texture", "radiant"],
                keyIngredients: ["vitamin E", "jojoba oil"],
                concerns: ["glow", "shimmer", "highlighting"],
                similarTo: [
                    { brand: "Anastasia Beverly Hills", product: "Amrezy Highlighter", price: 30 },
                    { brand: "ColourPop", product: "Super Shock Highlighter", price: 9 }
                ]
            },
            {
                id: "tone-adjusting-face-primer",
                name: "Tone Adjusting Face Primer",
                price: 10,
                rating: 4.3,
                reviews: 4100,
                badge: "Color-Correcting",
                badgeColor: "text-white",
                badgeStyle: "background-color: #4ADE80;",
                shades: ["#E8D5E8", "#B8E0B8", "#FFD8B8"],
                cta: "SELECT SHADE",
                image: "https://www.elfcosmetics.com/dw/image/v2/BBXC_PRD/on/demandware.static/-/Sites-elf-master/default/dwed6a3b79/2021/82846_OpenA_R.jpg?sfrm=png&sw=600&q=90",
                category: "makeup",
                skinType: ["All", "Normal", "Combination"],
                coverage: null,
                productType: "primer",
                routineStep: "morning",
                applicationOrder: 5,
                usage: "Apply color to target areas: lavender for sallow skin, green for redness, peach for dark circles.",
                benefits: ["color-correcting", "brightening", "smoothing", "even tone"],
                keyIngredients: ["niacinamide", "vitamin E"],
                concerns: ["uneven tone", "redness", "sallow skin", "dark circles"],
                similarTo: [
                    { brand: "NYX", product: "Color Correcting Primer", price: 14 },
                    { brand: "Smashbox", product: "Photo Finish Color Correcting Primer", price: 42 }
                ]
            },
            {
                id: "bronzing-drops",
                name: "Bronzing Drops",
                price: 12,
                rating: 4.7,
                reviews: 5800,
                badge: "Trending",
                badgeColor: "text-white",
                badgeStyle: "background-color: #F472B6;",
                shades: [],
                cta: "ADD TO BAG",
                image: "https://www.elfcosmetics.com/dw/image/v2/BBXC_PRD/on/demandware.static/-/Sites-elf-master/default/dw847a29b7/2024/BronzingDrops/57527/57527_Closed_R.jpg?sfrm=png&sw=600&q=90",
                category: "makeup",
                skinType: ["All", "Dry", "Normal"],
                coverage: null,
                productType: "bronzer",
                routineStep: "morning",
                applicationOrder: 6,
                usage: "Mix 1-3 drops with foundation or moisturizer for a custom bronze glow.",
                benefits: ["customizable bronze", "buildable", "natural glow", "mixable"],
                keyIngredients: ["squalane", "vitamin E"],
                concerns: ["bronzed look", "sun-kissed glow", "customization"],
                similarTo: [
                    { brand: "Isle of Paradise", product: "Self-Tanning Drops", price: 32 },
                    { brand: "Drunk Elephant", product: "D-Bronzi Anti-Pollution Bronzing Drops", price: 38 }
                ]
            }
        ];

        // ===========================================
        // SYSTEM PROMPTS FOR OPENAI
        // ===========================================
        const ROUTINE_SYSTEM_PROMPT = `You are an expert beauty advisor for e.l.f. Cosmetics. Create focused, realistic routines using ONLY products from the catalog.

CRITICAL RULES FOR ROUTINE SIZE:
- SKINCARE routine (morning/evening/night): MAX 4-5 products (cleanser, serum, moisturizer, SPF for morning)
- MAKEUP routine: MAX 5-6 products (primer, base/foundation, concealer, blush/bronzer, mascara, lip)
- "Full face" or "complete look": MAX 6-7 products total
- NEVER recommend 10+ products - that's overwhelming and unrealistic

ROUTINE TYPE GUIDELINES:
- "Morning routine" or "AM routine" = skincare only (3-4 steps) unless they say "with makeup"
- "Night routine" or "evening routine" = skincare only (3-4 steps), NO makeup
- "Skincare routine" = skincare products only
- "Makeup routine" = makeup products only, assume skincare is already done
- "Full routine" or "complete routine" = ask if they want skincare, makeup, or both

IMPORTANT:
1. ONLY use products from the catalog (match by id)
2. Keep it simple and achievable
3. Quality over quantity - recommend your TOP picks, not everything
4. Be encouraging but realistic

Return JSON in this format:
{
  "type": "routine",
  "title": "Your Morning Skincare Routine",
  "subtitle": "A simple 4-step routine for glowing skin",
  "steps": [
    {
      "stepNumber": 1,
      "stepName": "CLEANSE",
      "productId": "holy-hydration-cleanser",
      "instruction": "Specific instruction",
      "tip": "Optional pro tip"
    }
  ],
  "totalCost": 45,
  "summary": "Brief encouraging summary"
}

PRODUCT CATALOG:
`;

        const COMPARISON_SYSTEM_PROMPT = `You are an expert beauty advisor for e.l.f. Cosmetics specializing in finding affordable dupes. Your job is to find e.l.f. products that match high-end competitors.

IMPORTANT RULES:
1. ONLY recommend products from the provided catalog
2. Focus on products that have the competitor in their "similarTo" field
3. If no exact match exists, find the closest alternative based on product type and benefits
4. Calculate accurate savings
5. Be honest about similarities and differences
6. Always respond with valid JSON

Return JSON in this exact format:
{
  "type": "comparison",
  "competitorBrand": "Charlotte Tilbury",
  "competitorProduct": "Hollywood Flawless Filter",
  "competitorPrice": 49,
  "matches": [
    {
      "productId": "halo-glow-liquid-filter",
      "matchScore": 95,
      "savings": 35,
      "sharedBenefits": ["radiant finish", "natural coverage", "hydrating"],
      "differences": "e.l.f. version has slightly lighter coverage"
    }
  ],
  "summary": "A compelling summary of why the e.l.f. alternative is great"
}

PRODUCT CATALOG:
`;

        const GENERAL_SYSTEM_PROMPT = `You are elfvisor, a friendly AI shopping assistant for e.l.f. Cosmetics. Help users find the perfect beauty products.

Determine the user's intent:
- If they want a ROUTINE (skincare routine, makeup routine, morning routine, etc), set type to "routine"
- If they want a DUPE/COMPARISON (similar to, dupe for, alternative to, like X brand), set type to "comparison"  
- If it's a general product question, set type to "general"

Always respond with JSON:
{
  "type": "routine" | "comparison" | "general",
  "query_details": "extracted details about what they want"
}`;

        // ===========================================
        // STATE MANAGEMENT
        // ===========================================
        let currentSkinType = null;
        let currentCoverage = null;
        let currentView = 'empty'; // 'empty', 'grid', 'routine', 'comparison'
        let isLoading = false;
        let cartItems = []; // Array of { productId, quantity }
        let progressInterval = null;

        // ===========================================
        // DOM ELEMENTS
        // ===========================================
        const initialView = document.getElementById('initial-view');
        const splitView = document.getElementById('split-view');
        const chatPanel = document.getElementById('chat-panel');
        const chatHistory = document.getElementById('chat-history');
        const productPanel = document.getElementById('product-panel');
        const productGrid = document.getElementById('product-grid');
        const routineView = document.getElementById('routine-view');
        const comparisonView = document.getElementById('comparison-view');
        const initialInput = document.getElementById('initial-input');
        const chatInput = document.getElementById('chat-input');

        // ===========================================
        // HELPER FUNCTIONS
        // ===========================================
        function getProductById(id) {
            return ALL_PRODUCTS.find(p => p.id === id);
        }

        function getProductCatalogForPrompt() {
            return JSON.stringify(ALL_PRODUCTS.map(p => ({
                id: p.id,
                name: p.name,
                price: p.price,
                productType: p.productType,
                routineStep: p.routineStep,
                applicationOrder: p.applicationOrder,
                benefits: p.benefits,
                skinType: p.skinType,
                similarTo: p.similarTo,
                usage: p.usage
            })), null, 2);
        }

        function setInitialQuery(query) {
            initialInput.value = query;
            initialInput.focus();
        }

        function showView(viewName) {
            currentView = viewName;
            productGrid.classList.add('hidden');
            routineView.classList.add('hidden');
            comparisonView.classList.add('hidden');

            const chatInputWrapper = document.getElementById('chat-input-wrapper');

            // Only show split view when we have actual content
            if (viewName === 'grid' || viewName === 'routine' || viewName === 'comparison') {
                // Shrink chat panel and show product panel
                chatPanel.classList.remove('md:w-full');
                chatPanel.classList.add('md:w-[35%]', 'border-r', 'border-gray-100');
                
                // Remove centering constraints from chat elements
                chatHistory.classList.remove('max-w-2xl', 'mx-auto');
                if (chatInputWrapper) {
                    chatInputWrapper.classList.remove('max-w-2xl', 'mx-auto');
                }
                
                // Show product panel
                productPanel.classList.remove('hidden');
                
                switch(viewName) {
                    case 'grid':
                        productGrid.classList.remove('hidden');
                        break;
                    case 'routine':
                        routineView.classList.remove('hidden');
                        break;
                    case 'comparison':
                        comparisonView.classList.remove('hidden');
                        break;
                }
            }
        }

        // ===========================================
        // CART FUNCTIONS
        // ===========================================
        function addToCart(productId) {
            const existingItem = cartItems.find(item => item.productId === productId);
            
            if (existingItem) {
                existingItem.quantity += 1;
            } else {
                cartItems.push({ productId, quantity: 1 });
            }
            
            updateCartUI();
            showToast(getProductById(productId)?.name || 'Product');
            
            // Pulse animation on cart badge
            const badge = document.getElementById('cart-badge');
            badge.classList.remove('cart-pulse');
            void badge.offsetWidth; // Trigger reflow
            badge.classList.add('cart-pulse');
        }

        function removeFromCart(productId) {
            cartItems = cartItems.filter(item => item.productId !== productId);
            updateCartUI();
        }

        function updateCartQuantity(productId, delta) {
            const item = cartItems.find(item => item.productId === productId);
            if (item) {
                item.quantity += delta;
                if (item.quantity <= 0) {
                    removeFromCart(productId);
                } else {
                    updateCartUI();
                }
            }
        }

        function getCartTotal() {
            return cartItems.reduce((total, item) => {
                const product = getProductById(item.productId);
                return total + (product ? product.price * item.quantity : 0);
            }, 0);
        }

        function getCartItemCount() {
            return cartItems.reduce((count, item) => count + item.quantity, 0);
        }

        function updateCartUI() {
            const count = getCartItemCount();
            const total = getCartTotal();
            
            // Update badge
            const badge = document.getElementById('cart-badge');
            if (count > 0) {
                badge.classList.remove('hidden');
                badge.textContent = count > 99 ? '99+' : count;
            } else {
                badge.classList.add('hidden');
            }
            
            // Update drawer count
            document.getElementById('cart-count-drawer').textContent = count;
            
            // Update cart items list
            const cartItemsContainer = document.getElementById('cart-items');
            const cartEmpty = document.getElementById('cart-empty');
            const cartFooter = document.getElementById('cart-footer');
            
            if (cartItems.length === 0) {
                cartEmpty.classList.remove('hidden');
                cartFooter.classList.add('hidden');
                cartItemsContainer.innerHTML = '';
                cartItemsContainer.appendChild(cartEmpty);
            } else {
                cartEmpty.classList.add('hidden');
                cartFooter.classList.remove('hidden');
                
                cartItemsContainer.innerHTML = cartItems.map(item => {
                    const product = getProductById(item.productId);
                    if (!product) return '';
                    
                    return `
                        <div class="flex gap-4 p-4 bg-gray-50 rounded-xl">
                            <div class="w-20 h-20 bg-white rounded-lg p-2 flex-shrink-0">
                                <img src="${product.image}" alt="${product.name}" class="w-full h-full object-contain" />
                            </div>
                            <div class="flex-1">
                                <h4 class="font-bold text-sm mb-1">${product.name}</h4>
                                <p class="text-gray-600 font-medium">$${product.price}</p>
                                <div class="flex items-center gap-3 mt-2">
                                    <button onclick="updateCartQuantity('${item.productId}', -1)" class="w-7 h-7 rounded-full bg-gray-200 hover:bg-gray-300 flex items-center justify-center font-bold transition-colors">-</button>
                                    <span class="font-medium">${item.quantity}</span>
                                    <button onclick="updateCartQuantity('${item.productId}', 1)" class="w-7 h-7 rounded-full bg-gray-200 hover:bg-gray-300 flex items-center justify-center font-bold transition-colors">+</button>
                                    <button onclick="removeFromCart('${item.productId}')" class="ml-auto text-gray-400 hover:text-red-500 text-sm transition-colors">Remove</button>
                                </div>
                            </div>
                        </div>
                    `;
                }).join('');
            }
            
            // Update subtotal
            document.getElementById('cart-subtotal').textContent = `$${total}`;
            
            // Update shipping message
            const shippingMsg = document.getElementById('free-shipping-msg');
            const shippingRemaining = document.getElementById('shipping-remaining');
            if (total >= 35) {
                shippingMsg.classList.remove('bg-blue-50', 'text-blue-700');
                shippingMsg.classList.add('bg-green-50', 'text-green-700');
                shippingMsg.innerHTML = 'üéâ You qualify for FREE shipping!';
            } else {
                shippingMsg.classList.remove('bg-green-50', 'text-green-700');
                shippingMsg.classList.add('bg-blue-50', 'text-blue-700');
                shippingRemaining.textContent = `$${35 - total}`;
                shippingMsg.innerHTML = `Add <span class="font-bold">$${35 - total}</span> more for FREE shipping!`;
            }
        }

        function openCart() {
            document.getElementById('cart-drawer').classList.add('open');
            document.getElementById('cart-overlay').classList.add('open');
            document.body.style.overflow = 'hidden';
        }

        function closeCart() {
            document.getElementById('cart-drawer').classList.remove('open');
            document.getElementById('cart-overlay').classList.remove('open');
            document.body.style.overflow = '';
        }

        // ===========================================
        // TOAST NOTIFICATION
        // ===========================================
        function showToast(productName) {
            const toast = document.getElementById('toast');
            const message = document.getElementById('toast-message');
            message.textContent = `${productName} added to bag!`;
            
            toast.classList.add('show');
            
            setTimeout(() => {
                toast.classList.remove('show');
            }, 2500);
        }

        // ===========================================
        // TYPING ANIMATION
        // ===========================================
        async function typeMessage(element, text, speed = 20) {
            element.classList.add('typing-cursor');
            
            for (let i = 0; i < text.length; i++) {
                element.textContent += text[i];
                chatHistory.scrollTop = chatHistory.scrollHeight;
                
                // Variable speed for more natural feeling
                const char = text[i];
                let delay = speed;
                if (char === '.' || char === '!' || char === '?') delay = speed * 8;
                else if (char === ',') delay = speed * 4;
                else if (char === ' ') delay = speed * 0.5;
                
                await new Promise(resolve => setTimeout(resolve, delay));
            }
            
            element.classList.remove('typing-cursor');
        }

        async function addTypingMessage(htmlContent, plainText) {
            const msgDiv = document.createElement('div');
            msgDiv.className = 'flex justify-start fade-in';
            
            const bubble = document.createElement('div');
            bubble.className = 'max-w-[85%] p-4 text-sm leading-relaxed shadow-sm text-gray-800 rounded-2xl rounded-tl-sm';
            bubble.style.backgroundColor = '#F9FAFB';
            
            // Add the avatar first
            const avatarHTML = `
                <div class="flex gap-2 mb-2">
                    <div class="w-8 h-8 rounded-full bg-black flex items-center justify-center p-1.5">
                        <img src="logo-elf.svg" alt="elf" class="w-full h-full object-contain" />
                    </div>
                </div>
            `;
            bubble.innerHTML = avatarHTML;
            
            // Create text container for typing
            const textContainer = document.createElement('div');
            textContainer.className = 'space-y-2';
            bubble.appendChild(textContainer);
            
            msgDiv.appendChild(bubble);
            chatHistory.appendChild(msgDiv);
            chatHistory.scrollTop = chatHistory.scrollHeight;
            
            // Type out the message
            await typeMessage(textContainer, plainText);
            
            // After typing, replace with full HTML for proper formatting
            textContainer.innerHTML = htmlContent;
            
            return msgDiv;
        }

        // ===========================================
        // SMART LOADING STATES
        // ===========================================
        function showProgressMessage(type) {
            const steps = type === 'routine' 
                ? [
                    'Understanding your needs...',
                    'Analyzing your skin type...',
                    'Selecting the perfect products...',
                    'Building your personalized routine...'
                ]
                : type === 'comparison'
                ? [
                    'Searching for that product...',
                    'Finding e.l.f. alternatives...',
                    'Calculating your savings...'
                ]
                : [
                    'Understanding your request...',
                    'Finding the best products...'
                ];
            
            let currentStep = 0;
            
            const msgDiv = document.createElement('div');
            msgDiv.id = 'progress-message';
            msgDiv.className = 'flex justify-start fade-in';
            
            const bubble = document.createElement('div');
            bubble.className = 'max-w-[85%] p-4 text-sm leading-relaxed shadow-sm text-gray-800 rounded-2xl rounded-tl-sm';
            bubble.style.backgroundColor = '#F9FAFB';
            
            bubble.innerHTML = `
                <div class="flex items-center gap-3">
                    <div class="w-8 h-8 rounded-full bg-black flex items-center justify-center p-1.5">
                        <img src="logo-elf.svg" alt="elf" class="w-full h-full object-contain" />
                    </div>
                    <div>
                        <span id="progress-text" class="progress-step">${steps[0]}</span>
                    </div>
                </div>
            `;
            
            msgDiv.appendChild(bubble);
            chatHistory.appendChild(msgDiv);
            chatHistory.scrollTop = chatHistory.scrollHeight;
            
            // Cycle through steps
            progressInterval = setInterval(() => {
                currentStep++;
                if (currentStep < steps.length) {
                    const textEl = document.getElementById('progress-text');
                    if (textEl) {
                        textEl.className = '';
                        void textEl.offsetWidth; // Trigger reflow
                        textEl.className = 'progress-step';
                        textEl.textContent = steps[currentStep];
                    }
                }
            }, 800);
            
            return msgDiv;
        }

        function removeProgressMessage() {
            if (progressInterval) {
                clearInterval(progressInterval);
                progressInterval = null;
            }
            const progress = document.getElementById('progress-message');
            if (progress) progress.remove();
        }

        // ===========================================
        // OPENAI API INTEGRATION
        // ===========================================
        async function callOpenAI(systemPrompt, userMessage) {
            if (OPENAI_API_KEY === 'YOUR_OPENAI_API_KEY_HERE') {
                throw new Error('Please set your OpenAI API key in the code');
            }

            const response = await fetch('https://api.openai.com/v1/chat/completions', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                    'Authorization': `Bearer ${OPENAI_API_KEY}`
                },
                body: JSON.stringify({
                    model: 'gpt-4o-mini',
                    messages: [
                        { role: 'system', content: systemPrompt },
                        { role: 'user', content: userMessage }
                    ],
                    response_format: { type: 'json_object' },
                    temperature: 0.7
                })
            });

            if (!response.ok) {
                const error = await response.json();
                throw new Error(error.error?.message || 'API request failed');
            }

            const data = await response.json();
            return JSON.parse(data.choices[0].message.content);
        }

        async function detectIntent(userQuery) {
            try {
                const result = await callOpenAI(GENERAL_SYSTEM_PROMPT, userQuery);
                return result;
            } catch (error) {
                console.error('Intent detection error:', error);
                // Fallback to keyword detection
                const query = userQuery.toLowerCase();
                if (query.includes('routine') || query.includes('morning') || query.includes('evening') || query.includes('night')) {
                    return { type: 'routine', query_details: userQuery };
                } else if (query.includes('dupe') || query.includes('similar') || query.includes('alternative') || query.includes('like')) {
                    return { type: 'comparison', query_details: userQuery };
                }
                return { type: 'general', query_details: userQuery };
            }
        }

        async function generateRoutine(userQuery) {
            const catalog = getProductCatalogForPrompt();
            const fullPrompt = ROUTINE_SYSTEM_PROMPT + catalog;
            return await callOpenAI(fullPrompt, userQuery);
        }

        async function generateComparison(userQuery) {
            const catalog = getProductCatalogForPrompt();
            const fullPrompt = COMPARISON_SYSTEM_PROMPT + catalog;
            return await callOpenAI(fullPrompt, userQuery);
        }

        // ===========================================
        // UI RENDERING FUNCTIONS
        // ===========================================
        function addMessage(role, text, isHTML = false) {
            const msgDiv = document.createElement('div');
            msgDiv.className = `flex ${role === 'user' ? 'justify-end' : 'justify-start'} fade-in`;
            
            const bubble = document.createElement('div');
            bubble.className = `max-w-[85%] p-4 text-sm leading-relaxed shadow-sm ${
                role === 'user' 
                    ? 'bg-[#E8D6D1] text-black rounded-2xl rounded-tr-sm' 
                    : 'text-gray-800 rounded-2xl rounded-tl-sm'
            }`;
            if (role === 'ai' || role !== 'user') {
                bubble.style.backgroundColor = '#F9FAFB';
            }
            
            if (isHTML) {
                bubble.innerHTML = text;
            } else {
                bubble.innerText = text;
            }

            msgDiv.appendChild(bubble);
            chatHistory.appendChild(msgDiv);
            chatHistory.scrollTop = chatHistory.scrollHeight;
            return msgDiv;
        }

        function renderRoutineView(routineData) {
            let totalCost = 0;
            let stepsHTML = '';

            routineData.steps.forEach((step, index) => {
                const product = getProductById(step.productId);
                if (!product) return;
                
                totalCost += product.price;

                stepsHTML += `
                    <div class="routine-step relative flex gap-6 pb-8 fade-in" style="animation-delay: ${index * 0.1}s">
                        <!-- Step Number Circle -->
                        <div class="flex-shrink-0 w-12 h-12 rounded-full bg-black text-white flex items-center justify-center font-bold text-lg">
                            ${step.stepNumber}
                        </div>
                        
                        <!-- Step Content -->
                        <div class="flex-1 bg-gray-50 rounded-2xl p-6 hover:shadow-lg transition-shadow">
                            <div class="flex gap-4">
                                <!-- Product Image -->
                                <div class="w-24 h-24 flex-shrink-0 bg-white rounded-xl p-2 border border-gray-100">
                                    <img src="${product.image}" alt="${product.name}" class="w-full h-full object-contain" />
                                </div>
                                
                                <!-- Product Info -->
                                <div class="flex-1">
                                    <p class="text-xs font-bold text-gray-400 uppercase tracking-wider mb-1">${step.stepName}</p>
                                    <h3 class="font-bold text-lg mb-1">${product.name}</h3>
                                    <p class="text-sm text-gray-600 mb-3">${step.instruction}</p>
                                    ${step.tip ? `<p class="text-xs text-gray-500 italic">üí° ${step.tip}</p>` : ''}
                                </div>
                                
                                <!-- Price & CTA -->
                                <div class="flex flex-col items-end justify-between">
                                    <span class="font-bold text-lg">$${product.price}</span>
                                    <button onclick="handleAddClick(this, '${product.id}')" class="bg-black text-white text-xs font-bold py-2 px-4 rounded-full hover:bg-gray-800 transition-colors">
                                        ADD
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                `;
            });

            // Collect all product IDs for "Add All" functionality
            const allProductIds = routineData.steps.map(s => s.productId).filter(id => getProductById(id));

            routineView.innerHTML = `
                <div class="mb-8 text-center">
                    <h2 class="text-3xl font-bold mb-2">${routineData.title}</h2>
                    <p class="text-gray-600">${routineData.subtitle}</p>
                </div>
                
                <div class="space-y-2 mb-8">
                    ${stepsHTML}
                </div>
                
                <!-- Summary Card -->
                <div class="bg-gradient-to-r from-gray-900 to-black text-white rounded-2xl p-6 mt-8">
                    <div class="flex justify-between items-center mb-4">
                        <div>
                            <p class="text-sm text-gray-400">Complete Routine</p>
                            <p class="text-2xl font-bold">${routineData.steps.length} Products</p>
                        </div>
                        <div class="text-right">
                            <p class="text-sm text-gray-400">Total</p>
                            <p class="text-2xl font-bold">$${totalCost}</p>
                        </div>
                    </div>
                    <p class="text-sm text-gray-300 mb-4">${routineData.summary}</p>
                    <button onclick="addAllToCart(['${allProductIds.join("','")}'])" class="w-full bg-white text-black font-bold py-3 rounded-full hover:bg-gray-100 transition-colors">
                        ADD ALL TO BAG
                    </button>
                </div>
            `;

            showView('routine');
        }

        // Handle add button click with animation
        function handleAddClick(button, productId) {
            addToCart(productId);
            button.classList.add('add-btn-success');
            button.textContent = '‚úì ADDED';
            setTimeout(() => {
                button.classList.remove('add-btn-success');
                button.textContent = 'ADD';
            }, 1500);
        }

        // Add all products to cart
        function addAllToCart(productIds) {
            productIds.forEach(id => {
                if (id && getProductById(id)) {
                    const existingItem = cartItems.find(item => item.productId === id);
                    if (!existingItem) {
                        cartItems.push({ productId: id, quantity: 1 });
                    }
                }
            });
            updateCartUI();
            showToast(`${productIds.length} products`);
        }

        function renderComparisonView(comparisonData) {
            let matchesHTML = '';

            comparisonData.matches.forEach((match, index) => {
                const product = getProductById(match.productId);
                if (!product) return;

                const benefitsHTML = match.sharedBenefits.map(b => 
                    `<span class="inline-flex items-center gap-1 text-sm"><span class="text-green-500">‚úì</span> ${b}</span>`
                ).join('');

                matchesHTML += `
                    <div class="comparison-card rounded-2xl p-6 mb-6 fade-in" style="animation-delay: ${index * 0.15}s">
                        <div class="flex gap-8">
                            <!-- Competitor Side -->
                            <div class="flex-1 text-center opacity-50">
                                <div class="w-32 h-32 mx-auto bg-gray-200 rounded-xl flex items-center justify-center mb-4">
                                    <span class="text-4xl">üè∑Ô∏è</span>
                                </div>
                                <p class="text-sm text-gray-500">${comparisonData.competitorBrand}</p>
                                <p class="font-bold">${comparisonData.competitorProduct}</p>
                                <p class="text-xl font-bold mt-2">$${comparisonData.competitorPrice}</p>
                            </div>
                            
                            <!-- VS Divider -->
                            <div class="flex flex-col items-center justify-center">
                                <div class="w-12 h-12 rounded-full bg-black text-white flex items-center justify-center font-bold">
                                    VS
                                </div>
                                <div class="savings-badge text-white text-xs font-bold px-3 py-1 rounded-full mt-2">
                                    SAVE $${match.savings}
                                </div>
                            </div>
                            
                            <!-- ELF Side -->
                            <div class="flex-1 text-center">
                                <div class="w-32 h-32 mx-auto bg-white rounded-xl p-2 border-2 border-green-400 mb-4">
                                    <img src="${product.image}" alt="${product.name}" class="w-full h-full object-contain" />
                                </div>
                                <p class="text-sm text-gray-500">e.l.f. Cosmetics</p>
                                <p class="font-bold">${product.name}</p>
                                <p class="text-xl font-bold text-green-600 mt-2">$${product.price}</p>
                            </div>
                        </div>
                        
                        <!-- Match Score -->
                        <div class="mt-6 pt-6 border-t border-gray-200">
                            <div class="flex items-center justify-between mb-3">
                                <span class="text-sm font-medium">Match Score</span>
                                <span class="font-bold text-green-600">${match.matchScore}%</span>
                            </div>
                            <div class="w-full bg-gray-200 rounded-full h-2 mb-4">
                                <div class="bg-green-500 h-2 rounded-full" style="width: ${match.matchScore}%"></div>
                            </div>
                            
                            <!-- Shared Benefits -->
                            <p class="text-sm font-medium mb-2">What they share:</p>
                            <div class="flex flex-wrap gap-3 mb-4">
                                ${benefitsHTML}
                            </div>
                            
                            ${match.differences ? `<p class="text-sm text-gray-500 italic">Note: ${match.differences}</p>` : ''}
                        </div>
                        
                        <!-- CTA -->
                        <button onclick="handleAddClick(this, '${product.id}')" class="w-full mt-4 bg-black text-white font-bold py-3 rounded-full hover:bg-gray-800 transition-colors">
                            ADD ${product.name.toUpperCase()} TO BAG - $${product.price}
                        </button>
                    </div>
                `;
            });

            comparisonView.innerHTML = `
                <div class="mb-8 text-center">
                    <div class="inline-block bg-green-100 text-green-800 text-sm font-bold px-4 py-2 rounded-full mb-4">
                        üí∞ DUPE ALERT
                    </div>
                    <h2 class="text-3xl font-bold mb-2">e.l.f. Alternatives Found!</h2>
                    <p class="text-gray-600">Get the same look for less with these amazing dupes</p>
                </div>
                
                ${matchesHTML}
                
                <!-- Summary -->
                <div class="bg-gray-50 rounded-2xl p-6 text-center">
                    <p class="text-gray-700">${comparisonData.summary}</p>
                </div>
            `;

            showView('comparison');
        }

        function renderProducts(productList = ALL_PRODUCTS) {
            productGrid.innerHTML = '';

            productList.forEach(p => {
                const card = document.createElement('div');
                card.className = "flex flex-col p-4 relative group cursor-pointer hover:shadow-lg transition-shadow rounded-lg fade-in";
                
                let stars = '';
                for(let i=0; i<5; i++) {
                    stars += i < Math.floor(p.rating) ? '‚òÖ' : '‚òÜ';
                }

                let shadesHTML = '';
                if(p.shades && p.shades.length > 0) {
                    shadesHTML = `<div class="flex items-center gap-1 mb-3">`;
                    p.shades.slice(0,4).forEach(color => {
                        shadesHTML += `<div class="w-3 h-3 rounded-full border border-gray-200" style="background-color: ${color}"></div>`;
                    });
                    if(p.shades.length > 4) shadesHTML += `<span class="text-xs" style="color: #4B5563;">+${p.shades.length - 4}</span>`;
                    shadesHTML += `</div>`;
                } else {
                    shadesHTML = `<div class="h-3 mb-3"></div>`;
                }

                const badgeHTML = p.badge 
                    ? `<div class="absolute top-4 left-4 ${p.badgeColor || 'text-white'} text-[10px] font-bold px-2 py-1 rounded-full z-10 uppercase tracking-wider" style="${p.badgeStyle || 'background-color: #000000;'}">${p.badge}</div>` 
                    : '';

                let imageHTML;
                if(p.image) {
                     imageHTML = `<img src="${p.image}" alt="${p.name}" class="w-full h-full object-contain mix-blend-multiply hover:scale-105 transition-transform duration-500" />`;
                } else {
                     imageHTML = `<div class="text-4xl mb-2">${p.icon || 'üõçÔ∏è'}</div>`;
                }

                card.innerHTML = `
                    ${badgeHTML}
                    <button class="absolute top-4 right-4 z-10 text-gray-400 hover:text-black">‚ô°</button>

                    <div class="aspect-[3/4] bg-white border border-gray-50 mb-4 rounded-md flex items-center justify-center relative overflow-hidden p-2">
                         ${imageHTML}
                    </div>

                    <div class="flex items-center gap-1 text-xs mb-1 text-yellow-500">
                        <span>${stars}</span>
                        <span class="text-[10px]" style="color: #4B5563;">(${p.reviews})</span>
                    </div>

                    <h3 class="font-bold text-sm mb-2 leading-tight min-h-[40px]">${p.name}</h3>

                    ${shadesHTML}

                    <div class="mt-auto">
                        <div class="flex items-center justify-between gap-2 mb-2">
                            <button onclick="handleAddClick(this, '${p.id}')" class="bg-black text-white text-xs font-bold py-2 px-4 rounded-full flex-1 hover:bg-gray-800 transition-colors">
                            ${p.cta === 'SELECT SHADE' ? 'ADD TO BAG' : p.cta}
                            </button>
                            <span class="font-bold text-sm">$${p.price}</span>
                        </div>
                        <p class="text-[10px] font-medium leading-tight" style="color: #2563EB;">
                            FREE FULL SIZE GIFT + FREE SHIPPING WITH ORDERS OF $35+
                        </p>
                    </div>
                `;
                productGrid.appendChild(card);
            });

            showView('grid');
        }

        // ===========================================
        // MAIN CHAT HANDLERS
        // ===========================================
        async function processUserQuery(query) {
            if (isLoading) return;
            isLoading = true;

            // Show initial progress
            showProgressMessage('general');

            try {
                // Detect intent
                const intent = await detectIntent(query);
                removeProgressMessage();

                if (intent.type === 'routine') {
                    // Show routine-specific progress
                    showProgressMessage('routine');
                    const routineData = await generateRoutine(query);
                    removeProgressMessage();

                    // Add AI response with typing animation
                    const responseText = `I've created a personalized routine just for you! Check out the ${routineData.steps.length} products I've selected. Each step includes specific instructions for the best results.`;
                    const responseHTML = `
                        <p class="font-medium">I've created a personalized routine just for you! üåü</p>
                        <p class="text-gray-600">Check out the ${routineData.steps.length} products I've selected. Each step includes specific instructions for the best results.</p>
                    `;
                    await addTypingMessage(responseHTML, responseText);

                    renderRoutineView(routineData);

                } else if (intent.type === 'comparison') {
                    // Show comparison-specific progress
                    showProgressMessage('comparison');
                    const comparisonData = await generateComparison(query);
                    removeProgressMessage();

                    // Add AI response with typing animation
                    const savings = comparisonData.matches[0]?.savings || 0;
                    const responseText = `Great news! I found ${comparisonData.matches.length} e.l.f. alternative${comparisonData.matches.length > 1 ? 's' : ''} for you! You could save up to $${savings} with our dupe. Check out the comparison!`;
                    const responseHTML = `
                        <p class="font-medium">Great news! I found ${comparisonData.matches.length} e.l.f. alternative${comparisonData.matches.length > 1 ? 's' : ''} for you! üí∞</p>
                        <p class="text-gray-600">You could save up to <span class="font-bold text-green-600">$${savings}</span> with our dupe. Check out the comparison!</p>
                    `;
                    await addTypingMessage(responseHTML, responseText);

                    renderComparisonView(comparisonData);

                } else {
                    // General query - show product grid
                    const responseText = `Here are some products you might love! Browse our collection, or try asking me for a personalized skincare routine or an e.l.f. dupe for a high-end product.`;
                    const responseHTML = `
                        <p class="font-medium">Here are some products you might love! ‚ú®</p>
                        <p class="text-gray-600">Browse our collection, or try asking me for:</p>
                        <ul class="text-sm text-gray-500 list-disc list-inside mt-2">
                            <li>A personalized skincare routine</li>
                            <li>An e.l.f. dupe for a high-end product</li>
                        </ul>
                    `;
                    await addTypingMessage(responseHTML, responseText);

                    renderProducts(ALL_PRODUCTS);
                }

            } catch (error) {
                removeProgressMessage();
                console.error('Error processing query:', error);
                
                // Show error message with typing
                const errorMsg = error.message.includes('API key') 
                    ? 'Please set your OpenAI API key to enable AI features.' 
                    : 'Something went wrong.';
                const responseText = `Oops! ${errorMsg} In the meantime, check out our best-selling products!`;
                const responseHTML = `
                    <p class="font-medium">Oops! ${errorMsg}</p>
                    <p class="text-gray-600">In the meantime, check out our best-selling products! üëâ</p>
                `;
                await addTypingMessage(responseHTML, responseText);

                renderProducts(ALL_PRODUCTS);
            }

            isLoading = false;
        }

        function handleInitialSubmit() {
            const query = initialInput.value.trim();
            if (!query) return;

            // Transition UI
            initialView.style.opacity = '0';
            initialView.style.pointerEvents = 'none';
            
            splitView.classList.remove('pointer-events-none');
            splitView.style.opacity = '1';

            setTimeout(() => {
                document.getElementById('new-chat-btn').classList.remove('hidden');
            }, 500);

            // Add user message
            addMessage('user', query);

            // Process with AI
            processUserQuery(query);
        }

        function handleChatSubmit() {
            const query = chatInput.value.trim();
            if (!query || isLoading) return;

            addMessage('user', query);
            chatInput.value = '';

            processUserQuery(query);
        }

        // Enter key handlers
        initialInput.addEventListener('keypress', (e) => {
            if (e.key === 'Enter') handleInitialSubmit();
        });

        chatInput.addEventListener('keypress', (e) => {
            if (e.key === 'Enter') handleChatSubmit();
        });
    </script>
</body>
</html>
